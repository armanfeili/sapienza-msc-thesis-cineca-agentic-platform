<?xml version="1.0" encoding="UTF-8"?>
<!-- Do not edit this file with editors other than draw.io -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" style="background: #ffffff; background-color: light-dark(#ffffff, #121212); color-scheme: light dark;" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="2232px" height="2812px" viewBox="0 0 2232 2812" content="&lt;mxfile host=&quot;app.diagrams.net&quot; agent=&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36&quot; version=&quot;29.3.4&quot; scale=&quot;1&quot; border=&quot;0&quot;&gt;&#10;  &lt;diagram name=&quot;Page-1&quot; id=&quot;o7U-nxtfvU7QnVVJ9hKv&quot;&gt;&#10;    &lt;mxGraphModel dx=&quot;2168&quot; dy=&quot;796&quot; grid=&quot;1&quot; gridSize=&quot;10&quot; guides=&quot;1&quot; tooltips=&quot;1&quot; connect=&quot;1&quot; arrows=&quot;1&quot; fold=&quot;1&quot; page=&quot;1&quot; pageScale=&quot;1&quot; pageWidth=&quot;850&quot; pageHeight=&quot;1100&quot; background=&quot;#ffffff&quot; math=&quot;0&quot; shadow=&quot;0&quot;&gt;&#10;      &lt;root&gt;&#10;        &lt;mxCell id=&quot;0&quot; /&gt;&#10;        &lt;mxCell id=&quot;1&quot; parent=&quot;0&quot; /&gt;&#10;        &lt;mxCell id=&quot;omoz_kK5t07KWPeOI-yI-109&quot; edge=&quot;1&quot; parent=&quot;1&quot; source=&quot;HJKx42f4Jz2vHTe7KREf-90&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.25;entryDx=0;entryDy=0;&quot; target=&quot;EiYPZZWAnG0CHaq9ObTb-10&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;HJKx42f4Jz2vHTe7KREf-90&quot; parent=&quot;1&quot; style=&quot;swimlane;whiteSpace=wrap;html=1;startSize=40;fillColor=#E0DDEF;strokeColor=default;&quot; value=&quot;&amp;lt;div&amp;gt;IDENTITY &amp;amp;amp; AUTHENTICATION LAYER:&amp;amp;nbsp;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;CLIENTS &amp;amp;amp; USER INTERFACES&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;550&quot; width=&quot;570&quot; x=&quot;-690&quot; y=&quot;140&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle height=&quot;30&quot; width=&quot;140&quot; x=&quot;470&quot; y=&quot;210&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;HJKx42f4Jz2vHTe7KREf-6&quot; parent=&quot;HJKx42f4Jz2vHTe7KREf-90&quot; style=&quot;swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;align=center;fillColor=#F3F0FF;strokeColor=default;&quot; value=&quot;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;Identity Provider (OIDC / Auth0)&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;160&quot; width=&quot;550&quot; x=&quot;10&quot; y=&quot;50&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;HJKx42f4Jz2vHTe7KREf-7&quot; parent=&quot;HJKx42f4Jz2vHTe7KREf-6&quot; style=&quot;text;strokeColor=default;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;&quot; value=&quot;&amp;lt;div&amp;gt;- OAuth 2.0 login flow&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- JWT tokens (tenant_id, sub, roles[], scopes[], exp, iat)&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- JWKS endpoint for token verification&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Token refresh &amp;amp;amp; revocation&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Principal:&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;sub, tenant_id,&amp;amp;nbsp;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;roles: [admin, operator, user, viewer],&amp;amp;nbsp;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;scopes: [read, write, graph:read, ...]&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;130&quot; width=&quot;550&quot; y=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;HJKx42f4Jz2vHTe7KREf-14&quot; parent=&quot;HJKx42f4Jz2vHTe7KREf-90&quot; style=&quot;swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;fillColor=#F3F0FF;strokeColor=default;&quot; value=&quot;&amp;lt;div style=&amp;quot;text-align: left;&amp;quot;&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;Reverse Proxy / API Gateway (NGINX)&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;90&quot; width=&quot;550&quot; x=&quot;10&quot; y=&quot;450&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;HJKx42f4Jz2vHTe7KREf-15&quot; parent=&quot;HJKx42f4Jz2vHTe7KREf-14&quot; style=&quot;text;strokeColor=default;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;&quot; value=&quot;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;-&amp;amp;nbsp;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent;&amp;quot;&amp;gt;TLS termination (HTTPS)&amp;amp;nbsp;&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Routing to backend services&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- CORS handling&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;-&amp;amp;nbsp;Load balancing&amp;amp;nbsp;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;60&quot; width=&quot;550&quot; y=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;jL9Ayfw5SwNCbvacDRDm-101&quot; parent=&quot;HJKx42f4Jz2vHTe7KREf-90&quot; style=&quot;swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;fillColor=#F3F0FF;strokeColor=default;&quot; value=&quot;&amp;lt;div style=&amp;quot;text-align: left;&amp;quot;&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;Control Panel UI (Streamlit)&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;220&quot; width=&quot;270&quot; x=&quot;290&quot; y=&quot;215&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;jL9Ayfw5SwNCbvacDRDm-102&quot; parent=&quot;jL9Ayfw5SwNCbvacDRDm-101&quot; style=&quot;text;strokeColor=default;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;&quot; value=&quot;&amp;lt;div&amp;gt;&amp;lt;div&amp;gt;[LONG-RUNNING JOBS -&amp;amp;nbsp;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;WORKFLOW B&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;]&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Admin/Operator dashboard&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Jobs, models, tools management&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Graph/NL-&amp;amp;gt;Cypher experiments&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- SSE streaming for job events&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- ETL, backup, maintenance triggers&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent;&amp;quot;&amp;gt;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;POST /v1/jobs&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;- Bearer JWT, type, payload&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;- Job Types: demo, test, long-running, agent.run&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;- Returns: {id, status, created_at}&amp;lt;/div&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;190&quot; width=&quot;270&quot; y=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;omoz_kK5t07KWPeOI-yI-89&quot; parent=&quot;HJKx42f4Jz2vHTe7KREf-90&quot; style=&quot;swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;fillColor=#F3F0FF;&quot; value=&quot;&amp;lt;div style=&amp;quot;text-align: left;&amp;quot;&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;Agent Chat UI (Next.js / React)&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;220&quot; width=&quot;270&quot; x=&quot;10&quot; y=&quot;215&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;omoz_kK5t07KWPeOI-yI-90&quot; parent=&quot;omoz_kK5t07KWPeOI-yI-89&quot; style=&quot;text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;&quot; value=&quot;&amp;lt;div&amp;gt;&amp;lt;div&amp;gt;[AGENT RUN - WORKFLOW A]&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- End user chat interface&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- JWT-based authentication&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- SSE Streaming support&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Agent runs &amp;amp;amp; steps display&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Real-time polling for updates&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;div style=&amp;quot;font-size: 11px; text-wrap-mode: nowrap;&amp;quot;&amp;gt;POST /v1/agent-runs&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;font-size: 11px; text-wrap-mode: nowrap;&amp;quot;&amp;gt;- Bearer JWT, prompt, model, temperature&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;font-size: 11px; text-wrap-mode: nowrap;&amp;quot;&amp;gt;- Returns: {run_id, status: &amp;quot;queued&amp;quot;}&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;font-size: 11px; text-wrap-mode: nowrap;&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;190&quot; width=&quot;270&quot; y=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;jL9Ayfw5SwNCbvacDRDm-104&quot; edge=&quot;1&quot; parent=&quot;1&quot; source=&quot;EiYPZZWAnG0CHaq9ObTb-1&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;&quot; target=&quot;jL9Ayfw5SwNCbvacDRDm-99&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;omoz_kK5t07KWPeOI-yI-96&quot; connectable=&quot;0&quot; parent=&quot;jL9Ayfw5SwNCbvacDRDm-104&quot; style=&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];&quot; value=&quot;WORKFLOW B&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; x=&quot;0.2301&quot; y=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;-1&quot; y=&quot;7&quot; as=&quot;offset&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;omoz_kK5t07KWPeOI-yI-99&quot; edge=&quot;1&quot; parent=&quot;1&quot; source=&quot;EiYPZZWAnG0CHaq9ObTb-1&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;&quot; target=&quot;omoz_kK5t07KWPeOI-yI-91&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;Array as=&quot;points&quot;&gt;&#10;              &lt;mxPoint x=&quot;-405&quot; y=&quot;1030&quot; /&gt;&#10;              &lt;mxPoint x=&quot;255&quot; y=&quot;1030&quot; /&gt;&#10;            &lt;/Array&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;omoz_kK5t07KWPeOI-yI-101&quot; connectable=&quot;0&quot; parent=&quot;omoz_kK5t07KWPeOI-yI-99&quot; style=&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];&quot; value=&quot;WORKFLOW A&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; x=&quot;0.8817&quot; y=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;-1&quot; y=&quot;15&quot; as=&quot;offset&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;EiYPZZWAnG0CHaq9ObTb-1&quot; parent=&quot;1&quot; style=&quot;swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;fillColor=#D7E4D7;strokeColor=default;&quot; value=&quot;&amp;lt;div style=&amp;quot;text-align: left;&amp;quot;&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;API LAYER (Routers)&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;240&quot; width=&quot;570&quot; x=&quot;-690&quot; y=&quot;755&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;EiYPZZWAnG0CHaq9ObTb-2&quot; parent=&quot;EiYPZZWAnG0CHaq9ObTb-1&quot; style=&quot;text;strokeColor=default;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;&quot; value=&quot;&amp;lt;div&amp;gt;- /v1/health&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;- Health probes (live, ready, startup, components)&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- /v1/auth&amp;amp;nbsp; &amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;- Token introspection, identity verification&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- /v1/agents&amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp;- Agent definitions and configurations&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- /v1/agent-runs - Agent run lifecycle (create, poll, cancel)&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- /v1/tools&amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp; &amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;- MCP tool registry and invocation&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- /v1/jobs&amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp;&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;- Async job lifecycle (create, stream, cancel)&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- /v1/models&amp;amp;nbsp; &amp;amp;nbsp;&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;- Model and provider management&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- /v1/admin&amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp;&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;- Administrative operations&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- /v1/tenants&amp;amp;nbsp; &amp;amp;nbsp;&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;- Multi-tenant configuration&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- /v1/sessions&amp;amp;nbsp;&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;- Session management&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- /v1/graph&amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp;&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;- Graph query endpoints&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- /v1/batch&amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp;&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;- Batch operations&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- /v1/export&amp;amp;nbsp; &amp;amp;nbsp; &amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;- Data export utilities&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- /v1/internal&amp;amp;nbsp; &amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;- Internal diagnostics&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;210&quot; width=&quot;570&quot; y=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;EiYPZZWAnG0CHaq9ObTb-81&quot; edge=&quot;1&quot; parent=&quot;1&quot; source=&quot;EiYPZZWAnG0CHaq9ObTb-5&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=default;&quot; target=&quot;EiYPZZWAnG0CHaq9ObTb-29&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;EiYPZZWAnG0CHaq9ObTb-5&quot; parent=&quot;1&quot; style=&quot;swimlane;whiteSpace=wrap;html=1;fillColor=#EBDFBC;strokeColor=default;&quot; value=&quot;&amp;lt;div&amp;gt;SERVICE LAYER&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;700&quot; width=&quot;570&quot; x=&quot;-30&quot; y=&quot;1240&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;EiYPZZWAnG0CHaq9ObTb-6&quot; parent=&quot;EiYPZZWAnG0CHaq9ObTb-5&quot; style=&quot;swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;fillColor=#FFF2CC;strokeColor=default;&quot; value=&quot;&amp;lt;div style=&amp;quot;text-align: left;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;ORCHESTRATOR&amp;amp;nbsp;&amp;lt;/b&amp;gt;&amp;lt;b&amp;gt;SERVICE&amp;lt;/b&amp;gt;&amp;lt;b&amp;gt;: 1 Run per prompt,&amp;amp;nbsp;&amp;lt;/b&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; text-align: center;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;4 Phases&amp;lt;/b&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;500&quot; width=&quot;550&quot; x=&quot;10&quot; y=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;EiYPZZWAnG0CHaq9ObTb-7&quot; parent=&quot;EiYPZZWAnG0CHaq9ObTb-6&quot; style=&quot;text;strokeColor=default;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;&quot; value=&quot;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;PHASE 1) INTENT CLASSIFICATION:&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- A&amp;lt;span style=&amp;quot;background-color: transparent;&amp;quot;&amp;gt;nalyzes prompt via LLM&amp;lt;br&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent;&amp;quot;&amp;gt;- Check params.category → Match prompt catalog → Apply classify_intent()&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;:&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; - CHAT - Conversational responses&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; - GRAPH - Analytics, NL-&amp;amp;gt;Cypher queries&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; - SECURITY - Security/permissions questions&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; - ADMIN - Administrative write operations&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; - DANGEROUS - Destructive ops → refuse + offer EXPLAIN&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; - EXPLAIN - EXPLAIN-only query analysis&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;PHASE 2) TODO Planning&amp;lt;/b&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;b&amp;gt;&amp;amp;nbsp;(multi-step run):&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;- LLM-based planning&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;- Input: Goal + Context + Schema → Output: TODO Array&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;- Planning Modes: full (LLM per TODO) | optional (try direct) | none (deterministic)&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;PHASE 3) Step Execution,&amp;amp;nbsp;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;FOR EACH TODO&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;:&amp;lt;/span&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; 1. Call LLM Provider (planner, reflector, responder)&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; 2. Invoke MCP Tools with RBAC check (34 tools available)&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; 3. If GRAPH mode: NL-&amp;amp;gt;Cypher pipeline&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; 4. Persist step → PostgreSQL&amp;amp;nbsp;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;(via adaptor)&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; 5. Use Redis for session/cache/cancel&amp;amp;nbsp;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;(via adaptor)&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Step records: {id, action, input, output, latency_ms, started_at, finished_at}&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;PHASE 4)&amp;amp;nbsp;&amp;lt;/b&amp;gt;&amp;lt;b style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;Finalization &amp;amp;amp;&amp;amp;nbsp;&amp;lt;/b&amp;gt;&amp;lt;b style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;Response Generation&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;div&amp;gt;- build_response() → Orchestration Result&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Response mode selection: fallback-only | llm-best-effort&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Canonical output structure: {goal, steps[], outputs[], todos[], metrics}&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Normalize final output: text + optional JSON payload&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Safety/compliance: PII scrubbing + output guard checks&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Persist final state + metrics → PostgreSQL&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Observability: emit Prometheus metrics + OpenTelemetry traces&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;470&quot; width=&quot;550&quot; y=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;EiYPZZWAnG0CHaq9ObTb-8&quot; parent=&quot;EiYPZZWAnG0CHaq9ObTb-5&quot; style=&quot;swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;fillColor=#FFF2CC;strokeColor=default;&quot; value=&quot;&amp;lt;div style=&amp;quot;text-align: left;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;ADDITIONAL SERVICES&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;120&quot; width=&quot;550&quot; x=&quot;10&quot; y=&quot;560&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;EiYPZZWAnG0CHaq9ObTb-9&quot; parent=&quot;EiYPZZWAnG0CHaq9ObTb-8&quot; style=&quot;text;strokeColor=default;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;&quot; value=&quot;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;- Session Service (state management)&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Job Service (job lifecycle)&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Default Model Resolver&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Health / ETL / Archive Services&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Invocation Store (audit trail)&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;90&quot; width=&quot;550&quot; y=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;omoz_kK5t07KWPeOI-yI-110&quot; edge=&quot;1&quot; parent=&quot;1&quot; source=&quot;EiYPZZWAnG0CHaq9ObTb-10&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;exitX=0;exitY=0.75;exitDx=0;exitDy=0;&quot; target=&quot;EiYPZZWAnG0CHaq9ObTb-2&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;EiYPZZWAnG0CHaq9ObTb-10&quot; parent=&quot;1&quot; style=&quot;swimlane;whiteSpace=wrap;html=1;fillColor=#EAD6D6;strokeColor=default;rounded=0;absoluteArcSize=0;swimlaneFillColor=none;fillStyle=solid;&quot; value=&quot;&amp;lt;div style=&amp;quot;text-align: left;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;SECURITY&amp;amp;nbsp;&amp;lt;/b&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; text-align: center;&amp;quot;&amp;gt;MIDDLEWARE STACK&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;1050&quot; width=&quot;930&quot; x=&quot;610&quot; y=&quot;140&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;EiYPZZWAnG0CHaq9ObTb-11&quot; parent=&quot;EiYPZZWAnG0CHaq9ObTb-10&quot; style=&quot;swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;align=center;fillColor=#FFE9E9;strokeColor=default;&quot; value=&quot;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;1. CORS Handler - Cross-Origin Resource Sharing policy enforcement&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;90&quot; width=&quot;910&quot; x=&quot;10&quot; y=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;EiYPZZWAnG0CHaq9ObTb-12&quot; parent=&quot;EiYPZZWAnG0CHaq9ObTb-11&quot; style=&quot;text;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;strokeColor=default;&quot; value=&quot;&amp;lt;div&amp;gt;- Allowed origins, methods, headers configuration&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Preflight OPTIONS request handling&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Credentials and expose headers support&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;60&quot; width=&quot;910&quot; y=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;EiYPZZWAnG0CHaq9ObTb-13&quot; parent=&quot;EiYPZZWAnG0CHaq9ObTb-10&quot; style=&quot;swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;align=center;fillColor=#FFE9E9;strokeColor=default;&quot; value=&quot;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;2. Trace Context - OpenTelemetry distributed tracing context&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;90&quot; width=&quot;910&quot; x=&quot;10&quot; y=&quot;140&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;EiYPZZWAnG0CHaq9ObTb-14&quot; parent=&quot;EiYPZZWAnG0CHaq9ObTb-13&quot; style=&quot;text;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;strokeColor=default;&quot; value=&quot;&amp;lt;div&amp;gt;- Injects/extracts W3C trace-context headers (traceparent, tracestate)&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Creates root span if missing, propagates existing trace&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Adds trace_id, span_id, parent_id to request context&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;60&quot; width=&quot;910&quot; y=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;EiYPZZWAnG0CHaq9ObTb-15&quot; parent=&quot;EiYPZZWAnG0CHaq9ObTb-10&quot; style=&quot;swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;align=center;fillColor=#FFE9E9;strokeColor=default;&quot; value=&quot;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;3. Auth JWT - JWT/OIDC token validation and principal extraction&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;110&quot; width=&quot;910&quot; x=&quot;10&quot; y=&quot;240&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;EiYPZZWAnG0CHaq9ObTb-16&quot; parent=&quot;EiYPZZWAnG0CHaq9ObTb-15&quot; style=&quot;text;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;strokeColor=default;&quot; value=&quot;&amp;lt;div&amp;gt;- Validates Bearer token via JWKS endpoint (RS256/RS384/RS512)&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Extracts claims: sub, tenant_id, roles[], scopes[], exp, iat&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;div&amp;gt;- RBAC &amp;amp;amp; Scope Enforcement for endpoints&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Builds Principal object for downstream authorization&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; &amp;amp;nbsp;- Rejects expired/invalid/malformed tokens with 401 Unauthorized&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;80&quot; width=&quot;910&quot; y=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;EiYPZZWAnG0CHaq9ObTb-17&quot; parent=&quot;EiYPZZWAnG0CHaq9ObTb-10&quot; style=&quot;swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;align=center;fillColor=#FFE9E9;strokeColor=default;&quot; value=&quot;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;4. Rate Limit - Redis-backed rate limiting with multiple dimensions&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;110&quot; width=&quot;910&quot; x=&quot;10&quot; y=&quot;470&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;EiYPZZWAnG0CHaq9ObTb-18&quot; parent=&quot;EiYPZZWAnG0CHaq9ObTb-17&quot; style=&quot;text;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;strokeColor=default;&quot; value=&quot;&amp;lt;div&amp;gt;- Per-user limits: ratelimit:user:{sub}&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Per-tenant limits: ratelimit:tenant:{tenant_id}&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Per-endpoint limits: ratelimit:endpoint:{method}:{path}&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; &amp;amp;nbsp;- Sliding window algorithm, returns 429 Too Many Requests when exceeded&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; &amp;amp;nbsp;- X-RateLimit-Limit, X-RateLimit-Remaining, X-RateLimit-Reset headers&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;80&quot; width=&quot;910&quot; y=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;EiYPZZWAnG0CHaq9ObTb-19&quot; parent=&quot;EiYPZZWAnG0CHaq9ObTb-10&quot; style=&quot;swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;align=center;fillColor=#FFE9E9;strokeColor=default;&quot; value=&quot;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;5. Tenant Resolver - Multi-tenancy isolation and context resolution&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;100&quot; width=&quot;910&quot; x=&quot;10&quot; y=&quot;600&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;EiYPZZWAnG0CHaq9ObTb-20&quot; parent=&quot;EiYPZZWAnG0CHaq9ObTb-19&quot; style=&quot;text;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;strokeColor=default;&quot; value=&quot;&amp;lt;div&amp;gt;- Resolves tenant configuration from Redis cache or PostgreSQL&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Injects tenant_id filter into all database queries&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Enforces data isolation between tenants&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; &amp;amp;nbsp;- Loads tenant-specific settings (model defaults, feature flags)&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;70&quot; width=&quot;910&quot; y=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;EiYPZZWAnG0CHaq9ObTb-21&quot; parent=&quot;EiYPZZWAnG0CHaq9ObTb-10&quot; style=&quot;swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;align=center;fillColor=#FFE9E9;strokeColor=default;&quot; value=&quot;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;6. Input Guard - Request payload validation and sanitization&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;100&quot; width=&quot;910&quot; x=&quot;10&quot; y=&quot;710&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;EiYPZZWAnG0CHaq9ObTb-22&quot; parent=&quot;EiYPZZWAnG0CHaq9ObTb-21&quot; style=&quot;text;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;strokeColor=default;&quot; value=&quot;&amp;lt;div&amp;gt;- Pydantic schema validation for all request bodies&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Injection prevention (SQL, Cypher, command injection patterns)&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Content-type validation and size limits&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; &amp;amp;nbsp;- Malicious payload detection&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;70&quot; width=&quot;910&quot; y=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;EiYPZZWAnG0CHaq9ObTb-23&quot; parent=&quot;EiYPZZWAnG0CHaq9ObTb-10&quot; style=&quot;swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;align=center;fillColor=#FFE9E9;strokeColor=default;&quot; value=&quot;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;7. Output Guard - Response sanitization and compliance&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;100&quot; width=&quot;910&quot; x=&quot;10&quot; y=&quot;820&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;EiYPZZWAnG0CHaq9ObTb-24&quot; parent=&quot;EiYPZZWAnG0CHaq9ObTb-23&quot; style=&quot;text;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;strokeColor=default;&quot; value=&quot;&amp;lt;div&amp;gt;- PII scrubbing (email redaction, phone masking, SSN removal)&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Content filtering for sensitive data patterns&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Response size validation and truncation&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; &amp;amp;nbsp;- Audit logging of all responses with correlation IDs&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;70&quot; width=&quot;910&quot; y=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;EiYPZZWAnG0CHaq9ObTb-25&quot; parent=&quot;EiYPZZWAnG0CHaq9ObTb-10&quot; style=&quot;swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;align=center;fillColor=#FFE9E9;strokeColor=default;&quot; value=&quot;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;8. Error Handler - Centralized exception handling and error response formatting&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;100&quot; width=&quot;910&quot; x=&quot;10&quot; y=&quot;930&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;EiYPZZWAnG0CHaq9ObTb-26&quot; parent=&quot;EiYPZZWAnG0CHaq9ObTb-25&quot; style=&quot;text;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;strokeColor=default;&quot; value=&quot;&amp;lt;div&amp;gt;- PII scrubbing (email redaction, phone masking, SSN removal)&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Content filtering for sensitive data patterns&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Response size validation and truncation&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; &amp;amp;nbsp;- Audit logging of all responses with correlation IDs&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;70&quot; width=&quot;910&quot; y=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;EiYPZZWAnG0CHaq9ObTb-27&quot; parent=&quot;EiYPZZWAnG0CHaq9ObTb-10&quot; style=&quot;swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;fillColor=#FFE9E9;strokeColor=default;&quot; value=&quot;&amp;lt;div style=&amp;quot;text-align: left;&amp;quot;&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;RBAC PERMISSION MATRIX&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;100&quot; width=&quot;910&quot; x=&quot;10&quot; y=&quot;360&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;EiYPZZWAnG0CHaq9ObTb-28&quot; parent=&quot;EiYPZZWAnG0CHaq9ObTb-27&quot; style=&quot;text;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;strokeColor=default;&quot; value=&quot;&amp;lt;div&amp;gt;- admin:&amp;amp;nbsp; &amp;amp;nbsp; &amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;agent-runs=CRUD,&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;jobs=CRUD,&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;tools=CRUD,&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;tenants=CRUD,&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;graph(write)=✓&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- operator: &amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;agent-runs=CRU,&amp;amp;nbsp; &amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;jobs=CRUD, &amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;tools=R,&amp;amp;nbsp; &amp;amp;nbsp; &amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;tenants=R,&amp;amp;nbsp; &amp;amp;nbsp; &amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;graph(write)=✗&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- user:&amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp;&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;agent-runs=CR,&amp;amp;nbsp; &amp;amp;nbsp;&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;jobs=CRD,&amp;amp;nbsp; &amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;tools=R,&amp;amp;nbsp; &amp;amp;nbsp; &amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;tenants=✗,&amp;amp;nbsp; &amp;amp;nbsp; &amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;graph(write)=✗&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- viewer:&amp;amp;nbsp; &amp;amp;nbsp;&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;agent-runs=R,&amp;amp;nbsp; &amp;amp;nbsp; &amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;jobs=R,&amp;amp;nbsp; &amp;amp;nbsp; &amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;tools=R,&amp;amp;nbsp; &amp;amp;nbsp; &amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;tenants=✗,&amp;amp;nbsp; &amp;amp;nbsp; &amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;graph(write)=✗&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;70&quot; width=&quot;910&quot; y=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;EiYPZZWAnG0CHaq9ObTb-29&quot; parent=&quot;1&quot; style=&quot;swimlane;whiteSpace=wrap;html=1;fillColor=#EBDED4;strokeColor=default;&quot; value=&quot;&amp;lt;b style=&amp;quot;text-align: left;&amp;quot;&amp;gt;PHASE 3: Step Execution,&amp;amp;nbsp;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;FOR EACH TODO&amp;lt;/span&amp;gt;&amp;lt;/b&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;1340&quot; width=&quot;930&quot; x=&quot;610&quot; y=&quot;1440&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;EiYPZZWAnG0CHaq9ObTb-30&quot; parent=&quot;EiYPZZWAnG0CHaq9ObTb-29&quot; style=&quot;swimlane;whiteSpace=wrap;html=1;fillColor=#FFF1E6;strokeColor=default;&quot; value=&quot;&amp;lt;div style=&amp;quot;text-align: left;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent;&amp;quot;&amp;gt;Step 1) LLM PROVIDERS&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;230&quot; width=&quot;910&quot; x=&quot;10&quot; y=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;EiYPZZWAnG0CHaq9ObTb-31&quot; parent=&quot;EiYPZZWAnG0CHaq9ObTb-30&quot; style=&quot;swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;fillColor=#FFF1E6;strokeColor=default;&quot; value=&quot;&amp;lt;div style=&amp;quot;text-align: left;&amp;quot;&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;OpenAI&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;80&quot; width=&quot;430&quot; x=&quot;10&quot; y=&quot;140&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;EiYPZZWAnG0CHaq9ObTb-32&quot; parent=&quot;EiYPZZWAnG0CHaq9ObTb-31&quot; style=&quot;text;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;strokeColor=default;&quot; value=&quot;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;- Cloud LLM API&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- GPT-4, GPT-3.5, etc.&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;50&quot; width=&quot;430&quot; y=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;EiYPZZWAnG0CHaq9ObTb-33&quot; parent=&quot;EiYPZZWAnG0CHaq9ObTb-30&quot; style=&quot;swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;fillColor=#FFF1E6;strokeColor=default;&quot; value=&quot;&amp;lt;div style=&amp;quot;text-align: left;&amp;quot;&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;Ollama (Local)&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;90&quot; width=&quot;890&quot; x=&quot;10&quot; y=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;EiYPZZWAnG0CHaq9ObTb-34&quot; parent=&quot;EiYPZZWAnG0CHaq9ObTb-33&quot; style=&quot;text;strokeColor=default;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;&quot; value=&quot;&amp;lt;div&amp;gt;&amp;lt;div&amp;gt;- Local LLM hosting&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Self-hosted models:&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;(phi3:mini,&amp;amp;nbsp;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;Mistral,&amp;amp;nbsp;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;LLaMA,&amp;amp;nbsp;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;Qwen,&amp;amp;nbsp;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;Gemma)&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;60&quot; width=&quot;890&quot; y=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;EiYPZZWAnG0CHaq9ObTb-35&quot; parent=&quot;EiYPZZWAnG0CHaq9ObTb-30&quot; style=&quot;swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;align=center;fillColor=#FFF1E6;strokeColor=default;&quot; value=&quot;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;Azure OpenAI / Other Providers&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;80&quot; width=&quot;450&quot; x=&quot;450&quot; y=&quot;140&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;EiYPZZWAnG0CHaq9ObTb-36&quot; parent=&quot;EiYPZZWAnG0CHaq9ObTb-35&quot; style=&quot;text;strokeColor=default;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;&quot; value=&quot;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;- Compatible OpenAI-style APIs&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Enterprise deployments&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;50&quot; width=&quot;450&quot; y=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;EiYPZZWAnG0CHaq9ObTb-37&quot; parent=&quot;EiYPZZWAnG0CHaq9ObTb-29&quot; style=&quot;swimlane;fontStyle=1;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;fillColor=#FFF1E6;strokeColor=default;&quot; value=&quot;&amp;lt;div style=&amp;quot;text-align: left;&amp;quot;&amp;gt;&amp;lt;div&amp;gt;Step 2) MCP RUNTIME &amp;amp;amp; TOOLS (34 Tools, 12 Categories)&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;370&quot; width=&quot;910&quot; x=&quot;10&quot; y=&quot;285&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;EiYPZZWAnG0CHaq9ObTb-38&quot; parent=&quot;EiYPZZWAnG0CHaq9ObTb-37&quot; style=&quot;text;strokeColor=default;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;&quot; value=&quot;&amp;lt;div&amp;gt;&amp;lt;div&amp;gt;- Tool Registry (PostgreSQL-backed manifests)&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Tool Policies (RBAC per tool, required_scopes)&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- MCP Runtime (ToolContext, audit logging)&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Tool Invocation:&amp;amp;nbsp;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;Request → Schema Validation → RBAC Check → Execute → Audit Log&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;Tool Categories:&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- GRAPH&amp;amp;nbsp; &amp;amp;nbsp; &amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;- query, secure_query, generate_cypher, schema, explain&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- SECURITY &amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;- describe_principal, allowed_operations, validate&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- SYSTEM&amp;amp;nbsp; &amp;amp;nbsp;&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;- health, metrics, config, status&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- CACHE&amp;amp;nbsp; &amp;amp;nbsp; &amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;- get, set, delete, invalidate&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- CATALOG&amp;amp;nbsp; &amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;- discover, describe, search&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- MODEL&amp;amp;nbsp; &amp;amp;nbsp; &amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;- list, info, warmup, switch&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- AGENT&amp;amp;nbsp; &amp;amp;nbsp; &amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;- context, history, state&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- ANALYTICS &amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;- query, aggregate, visualize&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- ADMIN&amp;amp;nbsp; &amp;amp;nbsp; &amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;- create_index, drop_index, constraint&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- ETL&amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp; &amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;&amp;lt;/span&amp;gt;- import, export, transform&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- CRUD&amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp;&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;- create_node, update_node, delete_node&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- EXPORT&amp;amp;nbsp; &amp;amp;nbsp;&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;- csv, json, cypher&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;div&amp;gt;Tool Manifest (from PostgreSQL):&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;{name, description, input_schema, required_scopes,&amp;amp;nbsp;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;rate_limit: {requests: 100, window: 60}}&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;340&quot; width=&quot;910&quot; y=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;EiYPZZWAnG0CHaq9ObTb-39&quot; parent=&quot;EiYPZZWAnG0CHaq9ObTb-29&quot; style=&quot;swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;align=center;fillColor=#FFF1E6;strokeColor=default;&quot; value=&quot;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;Step 3) NL&amp;amp;nbsp;&amp;lt;span style=&amp;quot;text-align: left;&amp;quot;&amp;gt;→&amp;lt;/span&amp;gt;&amp;amp;nbsp;CYPHER PIPELINE&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;160&quot; width=&quot;910&quot; x=&quot;10&quot; y=&quot;670&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;EiYPZZWAnG0CHaq9ObTb-40&quot; parent=&quot;EiYPZZWAnG0CHaq9ObTb-39&quot; style=&quot;text;strokeColor=default;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;&quot; value=&quot;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;text-align: center;&amp;quot;&amp;gt;[In case of GRAPH mode]&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;text-align: center;&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;div&amp;gt;1. Normalize NL prompt → standardize user question&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;div&amp;gt;2. Catalog lookup (check if query matches known patterns in prompt catalog)&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;3. Generate Cypher → LLM-based or test hints&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;4. Validate Safety → read-only enforcement, tenant boundaries, injection prevention&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;5. Execute on Memgraph → run validated Cypher query&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;6. Summarize Results → convert graph results to natural language&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;130&quot; width=&quot;910&quot; y=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;L2pf3anQq07PFLFANsks-52&quot; parent=&quot;EiYPZZWAnG0CHaq9ObTb-29&quot; style=&quot;swimlane;whiteSpace=wrap;html=1;strokeColor=default;fillColor=#EADFE9;&quot; value=&quot;DATA &amp;amp;amp; INFRASTRUCTURE LAYER&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;480&quot; width=&quot;910&quot; x=&quot;10&quot; y=&quot;850&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;L2pf3anQq07PFLFANsks-53&quot; parent=&quot;L2pf3anQq07PFLFANsks-52&quot; style=&quot;swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;strokeColor=default;fillColor=#EADFE9;&quot; value=&quot;&amp;lt;div style=&amp;quot;text-align: left;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;PostgreSQL&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;240&quot; width=&quot;280&quot; x=&quot;330&quot; y=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;L2pf3anQq07PFLFANsks-54&quot; parent=&quot;L2pf3anQq07PFLFANsks-53&quot; style=&quot;text;strokeColor=default;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;&quot; value=&quot;&amp;lt;div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;Tables:&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- tenants&amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp;&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;- Multi-tenant configurations&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- agent_runs&amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp; &amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;- Agent run records with status&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- steps&amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp;&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;- Per-step execution records&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- sessions&amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp; &amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;- User session state&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- jobs&amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp; &amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;&amp;lt;/span&amp;gt;- Async job records&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- job_events&amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp; &amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;- Job progress events&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- tool_manifests&amp;amp;nbsp; &amp;amp;nbsp; &amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;- MCP tool definitions&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- model_defaults&amp;amp;nbsp; &amp;amp;nbsp; &amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;- Default model configurations&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- audit_logs&amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp; &amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;- All action audit trail&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;SQLAlchemy + Alembic migrations&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;Used by: App (Background Tasks)&amp;amp;nbsp;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;+ Workers&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;210&quot; width=&quot;280&quot; y=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;L2pf3anQq07PFLFANsks-55&quot; parent=&quot;L2pf3anQq07PFLFANsks-52&quot; style=&quot;swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;strokeColor=default;fillColor=#EADFE9;&quot; value=&quot;&amp;lt;div style=&amp;quot;text-align: left;&amp;quot;&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;Memgraph (Graph Database)&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;430&quot; width=&quot;280&quot; x=&quot;620&quot; y=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;L2pf3anQq07PFLFANsks-56&quot; parent=&quot;L2pf3anQq07PFLFANsks-55&quot; style=&quot;text;strokeColor=default;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;&quot; value=&quot;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;Nodes (14 b&amp;lt;/b&amp;gt;&amp;lt;b style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;ioinformatics&amp;lt;/b&amp;gt;&amp;lt;b style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;&amp;amp;nbsp;node types)&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- (:User&amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp; &amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;→&amp;amp;nbsp;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;{user_id, firstName, lastName, user_name, email})&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- (:Institution &amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;→&amp;amp;nbsp;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;{id, name, country, type})&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- (:Task&amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp; &amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;→&amp;amp;nbsp;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;{task_id, status, start, tags}) — e.g., Blast, CreateDb, SearchbyTaxon, Bold, Command&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- (:File&amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp; &amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;→&amp;amp;nbsp;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;{file_id, user_filename, size, extension, bucket_name}) — e.g., Fasta, BlastDb, Xml, BlastedSeq&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- (:Dataset&amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp;&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;→&amp;amp;nbsp;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;{id, name, description, version})&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- (:Sample&amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp; &amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;→&amp;amp;nbsp;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;{id, name, organism, tissue})&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- (:Experiment&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;→&amp;amp;nbsp;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;{id, name, protocol, date})&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- (:Publication &amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;→&amp;amp;nbsp;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;{id, doi, title, journal, year})&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- (:Gene&amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp; &amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;→&amp;amp;nbsp;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;{id, symbol, name, chromosome})&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- (:Protein&amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp;&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;→&amp;amp;nbsp;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;{id, name, sequence, function})&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- (:Pathway&amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp;&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;→&amp;amp;nbsp;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;{id, name, description})&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- (:Tool&amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp; &amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;→&amp;amp;nbsp;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;{id, name, version, type})&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- (:Workflow&amp;amp;nbsp; &amp;amp;nbsp; &amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;→&amp;amp;nbsp;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;{id, name, steps, inputs})&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- (:Result&amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp; &amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;→&amp;amp;nbsp;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;{id, type, metrics, timestamp})&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;Relationships (4 relationship types)&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;div&amp;gt;- (User)-[:WORKS_AT {since, role, department}]&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;→&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;(Institution)&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- (User)-[:RUNS]&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;→&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;(Task)&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- (File)-[:INPUT]&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;→&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;(Task)&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- (Task)-[:OUTPUT]&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;→&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;(File)&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;400&quot; width=&quot;280&quot; y=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;L2pf3anQq07PFLFANsks-57&quot; parent=&quot;L2pf3anQq07PFLFANsks-52&quot; style=&quot;swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;strokeColor=default;fillColor=#EADFE9;&quot; value=&quot;&amp;lt;div style=&amp;quot;text-align: left;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;Redis (Cache &amp;amp;amp; Queues)&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;330&quot; width=&quot;310&quot; x=&quot;10&quot; y=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;L2pf3anQq07PFLFANsks-58&quot; parent=&quot;L2pf3anQq07PFLFANsks-57&quot; style=&quot;text;strokeColor=default;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;&quot; value=&quot;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;&amp;lt;b&amp;gt;CACHE:&amp;lt;/b&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- session:{id}&amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp;&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;&amp;lt;/span&amp;gt;- Session data&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- tenant:config:{id}&amp;amp;nbsp; &amp;amp;nbsp;&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;- Tenant configurations&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- model:defaults:{id} &amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;- Model defaults&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;QUEUES:&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- jobs:queue:{type}&amp;amp;nbsp; &amp;amp;nbsp; &amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;- Job queue (LPUSH/BRPOP)&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- jobs:events:{id}&amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp;&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;- SSE event buffer (ring)&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- jobs:state:{id}&amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp; &amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;- Job state (HASH)&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;RATE LIMITING:&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- ratelimit:user:{id}&amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp;&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;- Per-user limits&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- ratelimit:tenant:{id}&amp;amp;nbsp; &amp;amp;nbsp;&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;- Per-tenant limits&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- ratelimit:endpoint:{}&amp;amp;nbsp; &amp;amp;nbsp;&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;- Per-endpoint limits&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;CONTROL:&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- idempotency:{key}&amp;amp;nbsp; &amp;amp;nbsp; &amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;- Idempotency mapping&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- circuit:{provider}&amp;amp;nbsp; &amp;amp;nbsp;&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;&amp;lt;/span&amp;gt;- Circuit breaker state&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;Used by: App (Background Tasks) + Workers&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;300&quot; width=&quot;310&quot; y=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;jL9Ayfw5SwNCbvacDRDm-103&quot; edge=&quot;1&quot; parent=&quot;1&quot; source=&quot;EiYPZZWAnG0CHaq9ObTb-29&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;&quot; target=&quot;jL9Ayfw5SwNCbvacDRDm-60&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;1055&quot; y=&quot;2790&quot; as=&quot;sourcePoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;omoz_kK5t07KWPeOI-yI-108&quot; connectable=&quot;0&quot; parent=&quot;jL9Ayfw5SwNCbvacDRDm-103&quot; style=&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];&quot; value=&quot;WORKFLOW B&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; x=&quot;-0.0793&quot; y=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;11&quot; y=&quot;1&quot; as=&quot;offset&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;omoz_kK5t07KWPeOI-yI-105&quot; edge=&quot;1&quot; parent=&quot;1&quot; source=&quot;EiYPZZWAnG0CHaq9ObTb-29&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;&quot; target=&quot;omoz_kK5t07KWPeOI-yI-103&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;1055&quot; y=&quot;2790&quot; as=&quot;sourcePoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;omoz_kK5t07KWPeOI-yI-107&quot; connectable=&quot;0&quot; parent=&quot;omoz_kK5t07KWPeOI-yI-105&quot; style=&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];&quot; value=&quot;WORKFLOW A&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; x=&quot;0.0528&quot; y=&quot;2&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;4&quot; y=&quot;-2&quot; as=&quot;offset&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;EiYPZZWAnG0CHaq9ObTb-85&quot; parent=&quot;1&quot; style=&quot;swimlane;whiteSpace=wrap;html=1;fillColor=#E0E0E0;fontColor=#333333;strokeColor=default;&quot; value=&quot;&amp;lt;b style=&amp;quot;text-align: left;&amp;quot;&amp;gt;BACKGROUND FRAMEWORK&amp;lt;/b&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;900&quot; width=&quot;570&quot; x=&quot;-30&quot; y=&quot;1970&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;EiYPZZWAnG0CHaq9ObTb-72&quot; parent=&quot;EiYPZZWAnG0CHaq9ObTb-85&quot; style=&quot;swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;fillColor=#F3F3F3;fontColor=#333333;strokeColor=default;&quot; value=&quot;&amp;lt;div style=&amp;quot;text-align: left;&amp;quot;&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;APScheduler&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;110&quot; width=&quot;550&quot; x=&quot;10&quot; y=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;EiYPZZWAnG0CHaq9ObTb-73&quot; parent=&quot;EiYPZZWAnG0CHaq9ObTb-72&quot; style=&quot;text;strokeColor=default;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;&quot; value=&quot;&amp;lt;div&amp;gt;Scheduled Tasks&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Health check (30s): Postgres ping, Redis ping, Memgraph ping, LLM warmup/availability&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Cleanup (hourly): stale/old sessions, expired/stale cache, expired jobs, old job records, orphan runs&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Backup (daily): PostgreSQL dump, Redis RDB snapshot, Memgraph archives, audit logs export&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Provider monitoring: provider health + metrics emission&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;80&quot; width=&quot;550&quot; y=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;EiYPZZWAnG0CHaq9ObTb-63&quot; parent=&quot;EiYPZZWAnG0CHaq9ObTb-85&quot; style=&quot;swimlane;whiteSpace=wrap;html=1;fillColor=#E0E0E0;fontColor=#333333;strokeColor=default;&quot; value=&quot;&amp;lt;b style=&amp;quot;text-align: left;&amp;quot;&amp;gt;OBSERVABILITY &amp;amp;amp; MONITORING&amp;lt;/b&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;730&quot; width=&quot;550&quot; x=&quot;10&quot; y=&quot;160&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;EiYPZZWAnG0CHaq9ObTb-64&quot; parent=&quot;EiYPZZWAnG0CHaq9ObTb-63&quot; style=&quot;swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;fillColor=#F3F3F3;fontColor=#333333;strokeColor=default;&quot; value=&quot;&amp;lt;div style=&amp;quot;text-align: left;&amp;quot;&amp;gt;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;&amp;lt;b&amp;gt;Prometheus (Metrics Collection)&amp;lt;/b&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;190&quot; width=&quot;530&quot; x=&quot;10&quot; y=&quot;530&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;EiYPZZWAnG0CHaq9ObTb-65&quot; parent=&quot;EiYPZZWAnG0CHaq9ObTb-64&quot; style=&quot;text;strokeColor=default;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;&quot; value=&quot;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;- Scrapes /metrics from: app &amp;amp;amp; workers&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Metrics collected:&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; - HTTP request latency &amp;amp;amp; throughput&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; - Agent run / step execution metrics&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; - Tool invocation metrics&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; - LLM token usage &amp;amp;amp; cost&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; - LLM provider health / circuit breaker states&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; - Job processing metrics&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; - Job queue depths&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; - System health status&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;160&quot; width=&quot;530&quot; y=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;EiYPZZWAnG0CHaq9ObTb-66&quot; parent=&quot;EiYPZZWAnG0CHaq9ObTb-63&quot; style=&quot;swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;fillColor=#F3F3F3;fontColor=#333333;strokeColor=default;&quot; value=&quot;&amp;lt;div style=&amp;quot;text-align: left;&amp;quot;&amp;gt;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;&amp;lt;b&amp;gt;Grafana (Dashboards)&amp;lt;/b&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;140&quot; width=&quot;530&quot; x=&quot;10&quot; y=&quot;380&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;EiYPZZWAnG0CHaq9ObTb-67&quot; parent=&quot;EiYPZZWAnG0CHaq9ObTb-66&quot; style=&quot;text;strokeColor=default;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;&quot; value=&quot;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;- Dashboards for:&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; - HTTP request metrics&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; - Agent run statistics (runs/steps)&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; - Job processing &amp;amp;amp; queue metrics&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; - Tool invocation stats&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; - LLM provider health &amp;amp;amp; circuit breaker states&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; - System / component health status&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;110&quot; width=&quot;530&quot; y=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;EiYPZZWAnG0CHaq9ObTb-68&quot; parent=&quot;EiYPZZWAnG0CHaq9ObTb-63&quot; style=&quot;swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;fillColor=#F3F3F3;fontColor=#333333;strokeColor=default;&quot; value=&quot;&amp;lt;div style=&amp;quot;text-align: left;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;Instrumentation &amp;amp;amp; Endpoints&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;150&quot; width=&quot;530&quot; x=&quot;10&quot; y=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;EiYPZZWAnG0CHaq9ObTb-69&quot; parent=&quot;EiYPZZWAnG0CHaq9ObTb-68&quot; style=&quot;text;strokeColor=default;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;&quot; value=&quot;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;- Prometheus /metrics endpoint (exposed by app &amp;amp;amp; workers)&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- OpenTelemetry tracing (OTLP export from app &amp;amp;amp; workers)&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Structured logging (JSON format)&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Health endpoints:&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; - /v1/health/live&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; - /v1/health/ready&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; - /v1/health/startup&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; - /v1/health/components&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;120&quot; width=&quot;530&quot; y=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;EiYPZZWAnG0CHaq9ObTb-70&quot; parent=&quot;EiYPZZWAnG0CHaq9ObTb-63&quot; style=&quot;swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;fillColor=#F3F3F3;fontColor=#333333;strokeColor=default;&quot; value=&quot;&amp;lt;div style=&amp;quot;text-align: left;&amp;quot;&amp;gt;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;&amp;lt;b&amp;gt;Tracing (OTel Collector + APM Backend)&amp;lt;/b&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;170&quot; width=&quot;530&quot; x=&quot;10&quot; y=&quot;200&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;EiYPZZWAnG0CHaq9ObTb-71&quot; parent=&quot;EiYPZZWAnG0CHaq9ObTb-70&quot; style=&quot;text;strokeColor=default;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;&quot; value=&quot;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;- OTel Collector / APM:&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; - Receives OTLP traces from: app &amp;amp;amp; workers&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; - Exports to: Jaeger / Tempo / APM backend&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Trace spans include:&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; - Agent run execution (end-to-end)&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; - Step-by-step processing&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; - Tool invocations&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; - Database queries&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; - Job lifecycle (enqueue → execute → complete/fail/cancel)&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;140&quot; width=&quot;530&quot; y=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;jL9Ayfw5SwNCbvacDRDm-108&quot; edge=&quot;1&quot; parent=&quot;1&quot; source=&quot;jL9Ayfw5SwNCbvacDRDm-99&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;&quot; target=&quot;jL9Ayfw5SwNCbvacDRDm-20&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;omoz_kK5t07KWPeOI-yI-111&quot; connectable=&quot;0&quot; parent=&quot;jL9Ayfw5SwNCbvacDRDm-108&quot; style=&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];&quot; value=&quot;WORKFLOW B&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; x=&quot;-0.1197&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint as=&quot;offset&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;jL9Ayfw5SwNCbvacDRDm-99&quot; parent=&quot;1&quot; style=&quot;swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;fillColor=#EAF7EA;strokeColor=default;&quot; value=&quot;&amp;lt;div style=&amp;quot;text-align: left;&amp;quot;&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;[&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;LONG-RUNNING JOB ENDPOINTS&amp;lt;/span&amp;gt;]&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;100&quot; width=&quot;320&quot; x=&quot;-565&quot; y=&quot;1090&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;jL9Ayfw5SwNCbvacDRDm-100&quot; parent=&quot;jL9Ayfw5SwNCbvacDRDm-99&quot; style=&quot;text;strokeColor=default;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;&quot; value=&quot;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;- POST /v1/jobs → HTTP 202 + Location header&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- GET /v1/jobs/{id}&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- GET /v1/jobs/{id}/events (SSE streaming)&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- DELETE /v1/jobs/{id} (cancellation via Redis Lua script)&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;70&quot; width=&quot;320&quot; y=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;jL9Ayfw5SwNCbvacDRDm-107&quot; edge=&quot;1&quot; parent=&quot;1&quot; source=&quot;jL9Ayfw5SwNCbvacDRDm-20&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;&quot; target=&quot;jL9Ayfw5SwNCbvacDRDm-93&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;jL9Ayfw5SwNCbvacDRDm-20&quot; parent=&quot;1&quot; style=&quot;swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;fillColor=#D7DEEB;strokeColor=default;&quot; value=&quot;&amp;lt;div style=&amp;quot;text-align: left;&amp;quot;&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;JOB CREATION &amp;amp;amp; ENQUEUE&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;210&quot; width=&quot;570&quot; x=&quot;-690&quot; y=&quot;1240&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;jL9Ayfw5SwNCbvacDRDm-21&quot; parent=&quot;jL9Ayfw5SwNCbvacDRDm-20&quot; style=&quot;text;strokeColor=default;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;&quot; value=&quot;&amp;lt;div&amp;gt;JOB CREATION FLOW:&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Validate job request (Pydantic schema)&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Validate payload against JSON Schema for job type&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Check idempotency key (Redis + PostgreSQL)&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Create Job record (status=queued) → PostgreSQL&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- LPUSH job_id → Redis queue: jobs:queue:{type}&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- HSET job state → Redis: jobs:state:{id}&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Cache idempotency mapping → Redis&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Return HTTP 202 + JobResponse {id, status, created_at} + Location header&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Job Types: demo, test, long-running, agent.run&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;Redis Queue (Job IDs) → To Workers via BRPOP&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;180&quot; width=&quot;570&quot; y=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;jL9Ayfw5SwNCbvacDRDm-106&quot; edge=&quot;1&quot; parent=&quot;1&quot; source=&quot;jL9Ayfw5SwNCbvacDRDm-93&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=default;&quot; target=&quot;EiYPZZWAnG0CHaq9ObTb-5&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;jL9Ayfw5SwNCbvacDRDm-93&quot; parent=&quot;1&quot; style=&quot;swimlane;whiteSpace=wrap;html=1;fillColor=#D6E4EB;strokeColor=default;&quot; value=&quot;WORKERS&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;710&quot; width=&quot;570&quot; x=&quot;-690&quot; y=&quot;1500&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;jL9Ayfw5SwNCbvacDRDm-94&quot; parent=&quot;jL9Ayfw5SwNCbvacDRDm-93&quot; style=&quot;swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;fillColor=#E9F7FF;strokeColor=default;&quot; value=&quot;&amp;lt;div style=&amp;quot;text-align: left;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;SSE STREAMING TO CONTROL PANEL&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;90&quot; width=&quot;550&quot; x=&quot;10&quot; y=&quot;610&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;jL9Ayfw5SwNCbvacDRDm-95&quot; parent=&quot;jL9Ayfw5SwNCbvacDRDm-94&quot; style=&quot;text;strokeColor=default;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;&quot; value=&quot;&amp;lt;div&amp;gt;- Control Panel subscribes: GET /v1/jobs/{id}/events (Server-Sent Events)&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Backend streams events from PostgreSQL + Redis buffer&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- UI displays: real-time progress, logs, final status&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;60&quot; width=&quot;550&quot; y=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;jL9Ayfw5SwNCbvacDRDm-96&quot; parent=&quot;jL9Ayfw5SwNCbvacDRDm-93&quot; style=&quot;swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;fillColor=#E9F7FF;strokeColor=default;&quot; value=&quot;&amp;lt;div style=&amp;quot;text-align: left;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;Job Processing Worker&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;560&quot; width=&quot;550&quot; x=&quot;10&quot; y=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;jL9Ayfw5SwNCbvacDRDm-97&quot; parent=&quot;jL9Ayfw5SwNCbvacDRDm-96&quot; style=&quot;text;strokeColor=default;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;&quot; value=&quot;&amp;lt;div&amp;gt;WORKER PROCESSING LOOP FOR EACH JOB:&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;1. Pop job ID: BRPOP jobs:queue:{type} (blocking wait)&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;2. Load job metadata from PostgreSQL&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;3. Check pre-execution cancellation flag (Redis)&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;4. Update status: queued → running&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;5. Append status event to job_events table&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;6. Start async heartbeat task&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;7. Execute handler (uses same adapters: Memgraph, LLM, Redis):&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; &amp;amp;nbsp;- demo jobs: simple demonstration&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; &amp;amp;nbsp;- test jobs: testing purposes&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; &amp;amp;nbsp;- long-running jobs: extended analysis&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; &amp;amp;nbsp;- agent.run jobs: async agent execution (orchestrator integration)&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp;• Load/Create AgentRun record → PostgreSQL&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp;• Update AgentRun status: queued → running&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp;• Emit SSE: agent_run_started&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp;• Initialize Orchestrator.from_env()&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp;• Emit SSE: orchestrator_init&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp;• Execute orchestrator.run() with timeout&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp;• LLM calls, MCP tools, Graph queries&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp;• Persist steps per-step → PostgreSQL&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp;• Session state → Redis&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp;• Check cancellation between steps&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp;• Emit progress events per orchestration step&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp;• Apply PII scrubbing &amp;amp;amp; output guard&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp;• Emit agent-specific Prometheus metrics&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp;• Update AgentRun status → succeeded | failed&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;8. Periodically check cancellation flags (Redis: jobs:cancel:{id})&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;9. Emit progress events → RPUSH jobs:events:{id} → SSE to Control Panel&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;10. On completion: status = finished | failed | cancelled&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;11. Persist result → PostgreSQL&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;12. Append terminal event to job_events&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;Job Status State Machine: queued → running → finished | failed | cancelled&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;Resources: 2 CPU, 4GB RAM&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;Uses same adapters/services as main app (shared codebase)&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;530&quot; width=&quot;550&quot; y=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;jL9Ayfw5SwNCbvacDRDm-60&quot; parent=&quot;1&quot; style=&quot;swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;fillColor=#DAE4E6;strokeColor=default;&quot; value=&quot;&amp;lt;div style=&amp;quot;text-align: left;&amp;quot;&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;PHASE 4)&amp;amp;nbsp;&amp;lt;/b&amp;gt;&amp;lt;b&amp;gt;Long-Running Job Completion&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;120&quot; width=&quot;430&quot; x=&quot;1110&quot; y=&quot;2830&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;jL9Ayfw5SwNCbvacDRDm-61&quot; parent=&quot;jL9Ayfw5SwNCbvacDRDm-60&quot; style=&quot;text;strokeColor=default;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;&quot; value=&quot;&amp;lt;div&amp;gt;- State machine: queued → running → finished | failed | cancelled&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Persist job status → PostgreSQL&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Append progress/state events → job_events table&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Progress event format: {stage, message, percent}&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Stream updates via SSE to Control Panel (heartbeat keep-alive)&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Emit and persist terminal status: finished | failed | cancelled&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;90&quot; width=&quot;430&quot; y=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;omoz_kK5t07KWPeOI-yI-97&quot; edge=&quot;1&quot; parent=&quot;1&quot; source=&quot;omoz_kK5t07KWPeOI-yI-91&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;&quot; target=&quot;EiYPZZWAnG0CHaq9ObTb-5&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;omoz_kK5t07KWPeOI-yI-102&quot; connectable=&quot;0&quot; parent=&quot;omoz_kK5t07KWPeOI-yI-97&quot; style=&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];&quot; value=&quot;WORKFLOW A&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; x=&quot;-0.1467&quot; y=&quot;2&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;-2&quot; y=&quot;3&quot; as=&quot;offset&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;omoz_kK5t07KWPeOI-yI-91&quot; parent=&quot;1&quot; style=&quot;swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;fillColor=#EAF7EA;&quot; value=&quot;&amp;lt;div style=&amp;quot;text-align: left;&amp;quot;&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;[AGENT RUN ENDPOINTS]&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;100&quot; width=&quot;340&quot; x=&quot;85&quot; y=&quot;1090&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;omoz_kK5t07KWPeOI-yI-92&quot; parent=&quot;omoz_kK5t07KWPeOI-yI-91&quot; style=&quot;text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;&quot; value=&quot;&amp;lt;div&amp;gt;- POST /v1/agent-runs (use_jobs=false → BackgroundTasks)&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- POST /v1/agent-runs?use_jobs=true (→ Jobs Worker)&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- GET /v1/agent-runs/{id} (ETag support for caching)&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- GET /v1/agent-runs/{id}/steps&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;70&quot; width=&quot;340&quot; y=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;omoz_kK5t07KWPeOI-yI-98&quot; connectable=&quot;0&quot; parent=&quot;1&quot; style=&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];&quot; value=&quot;WORKFLOW B&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-90&quot; y=&quot;1720&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;13&quot; y=&quot;1&quot; as=&quot;offset&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;omoz_kK5t07KWPeOI-yI-103&quot; parent=&quot;1&quot; style=&quot;swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;fillColor=#DAE4E6;&quot; value=&quot;&amp;lt;div style=&amp;quot;text-align: left;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;PHASE 4) Agent Run Completion&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;120&quot; width=&quot;480&quot; x=&quot;610&quot; y=&quot;2830&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;omoz_kK5t07KWPeOI-yI-104&quot; parent=&quot;omoz_kK5t07KWPeOI-yI-103&quot; style=&quot;text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;&quot; value=&quot;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;- State machine: queued → running → succeeded | failed&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Record provenance event for the completed run&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Build API payload: AgentRunResponse {id, status, outputs[], steps[], todos[], metrics}&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Return HTTP response to client&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- UI polling for updates: GET /agent-runs/{id} (ETag support)&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;90&quot; width=&quot;480&quot; y=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;L2pf3anQq07PFLFANsks-40&quot; parent=&quot;1&quot; style=&quot;swimlane;whiteSpace=wrap;html=1;strokeColor=default;fillColor=#EAFFFB;&quot; value=&quot;ADAPTERS &amp;amp;amp; RESILIENCE FRAMEWORK&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;180&quot; width=&quot;930&quot; x=&quot;610&quot; y=&quot;1240&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;L2pf3anQq07PFLFANsks-41&quot; parent=&quot;L2pf3anQq07PFLFANsks-40&quot; style=&quot;swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;strokeColor=default;fillColor=#EAFFFB;&quot; value=&quot;&amp;lt;div style=&amp;quot;text-align: left;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;LLM Adapters&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;130&quot; width=&quot;173.75&quot; x=&quot;16.25&quot; y=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;L2pf3anQq07PFLFANsks-42&quot; parent=&quot;L2pf3anQq07PFLFANsks-41&quot; style=&quot;text;strokeColor=default;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;&quot; value=&quot;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;- Ollama adapter (local LLMs)&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;- OpenAI-style API adapter&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Stub/Demo adapter (testing)&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Azure OpenAI adapter&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;100&quot; width=&quot;173.75&quot; y=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;L2pf3anQq07PFLFANsks-43&quot; parent=&quot;L2pf3anQq07PFLFANsks-40&quot; style=&quot;swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;strokeColor=default;fillColor=#EAFFFB;&quot; value=&quot;&amp;lt;div style=&amp;quot;text-align: left;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;Resilience Mechanisms&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;130&quot; width=&quot;411.87&quot; x=&quot;198.13&quot; y=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;L2pf3anQq07PFLFANsks-44&quot; parent=&quot;L2pf3anQq07PFLFANsks-43&quot; style=&quot;text;strokeColor=default;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;&quot; value=&quot;&amp;lt;div&amp;gt;- Circuit Breaker States per provider:&amp;amp;nbsp;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;CLOSED (normal) → OPEN (reject) →&amp;amp;nbsp;&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt;&amp;#x9;&amp;lt;/span&amp;gt;HALF_OPEN (test one) → CLOSED&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;- Automatic Retries with exponential backoff&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Cost Tracking per provider/model&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- Provider Fallback chain&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;100&quot; width=&quot;411.87&quot; y=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;L2pf3anQq07PFLFANsks-45&quot; parent=&quot;L2pf3anQq07PFLFANsks-40&quot; style=&quot;swimlane;whiteSpace=wrap;html=1;strokeColor=default;fillColor=#EAFFFB;startSize=30;&quot; value=&quot;Database Adapters&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;130&quot; width=&quot;300&quot; x=&quot;620&quot; y=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;L2pf3anQq07PFLFANsks-46&quot; parent=&quot;L2pf3anQq07PFLFANsks-45&quot; style=&quot;swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;align=center;strokeColor=default;fillColor=#EAFFFB;&quot; value=&quot;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;Redis Adapter&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;80&quot; width=&quot;80&quot; x=&quot;10&quot; y=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;L2pf3anQq07PFLFANsks-47&quot; parent=&quot;L2pf3anQq07PFLFANsks-46&quot; style=&quot;text;strokeColor=default;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;&quot; value=&quot;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;- cache&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;- queues&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;- rate limits&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;50&quot; width=&quot;80&quot; y=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;L2pf3anQq07PFLFANsks-48&quot; parent=&quot;L2pf3anQq07PFLFANsks-45&quot; style=&quot;swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;align=center;strokeColor=default;fillColor=#EAFFFB;&quot; value=&quot;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;PostgreSQL Adapter&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;80&quot; width=&quot;90&quot; x=&quot;95&quot; y=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;L2pf3anQq07PFLFANsks-49&quot; parent=&quot;L2pf3anQq07PFLFANsks-48&quot; style=&quot;text;strokeColor=default;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;&quot; value=&quot;&amp;lt;div&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;- repositories&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;- transactions&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;50&quot; width=&quot;90&quot; y=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;L2pf3anQq07PFLFANsks-50&quot; parent=&quot;L2pf3anQq07PFLFANsks-45&quot; style=&quot;swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;align=center;strokeColor=default;fillColor=#EAFFFB;&quot; value=&quot;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;Memgraph Adapter&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;80&quot; width=&quot;100&quot; x=&quot;190&quot; y=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;L2pf3anQq07PFLFANsks-51&quot; parent=&quot;L2pf3anQq07PFLFANsks-50&quot; style=&quot;text;strokeColor=default;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;&quot; value=&quot;&amp;lt;div&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;- graph queries&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;- NL-&amp;amp;gt;Cypher&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;50&quot; width=&quot;100&quot; y=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;      &lt;/root&gt;&#10;    &lt;/mxGraphModel&gt;&#10;  &lt;/diagram&gt;&#10;&lt;/mxfile&gt;&#10;"><defs/><rect fill="#ffffff" width="100%" height="100%" x="0" y="0" style="fill: light-dark(rgb(255, 255, 255), rgb(18, 18, 18));"/><g><g data-cell-id="0"><g data-cell-id="1"><g data-cell-id="omoz_kK5t07KWPeOI-yI-109"><g transform="translate(0.5,0.5)"><path d="M 570 275 L 935 275 L 935 262.56 L 1293.63 262.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1298.88 262.5 L 1291.88 266 L 1293.63 262.5 L 1291.88 259 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="HJKx42f4Jz2vHTe7KREf-90"><g transform="translate(0.5,0.5)"><path d="M 0 40 L 0 0 L 570 0 L 570 40" fill="#e0ddef" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(224, 221, 239), rgb(46, 44, 59)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 0 40 L 0 550 L 570 550 L 570 40" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 0 40 L 570 40" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 568px; height: 1px; padding-top: 20px; margin-left: 1px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; "><div>IDENTITY &amp; AUTHENTICATION LAYER: <span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">CLIENTS &amp; USER INTERFACES</span></div></div></div></div></foreignObject><text x="285" y="24" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">IDENTITY &amp; AUTHENTICATION LAYER: CLIENTS &amp; USER INTERFACES</text></switch></g></g><g data-cell-id="HJKx42f4Jz2vHTe7KREf-6"><g transform="translate(0.5,0.5)"><path d="M 10 80 L 10 50 L 560 50 L 560 80" fill="#f3f0ff" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(243, 240, 255), rgb(31, 28, 41)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 10 80 L 10 210 L 560 210 L 560 80" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 10 80 L 560 80" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 548px; height: 1px; padding-top: 65px; margin-left: 11px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style=""><b>Identity Provider (OIDC / Auth0)</b></div></div></div></div></foreignObject><text x="285" y="69" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">Identity Provider (OIDC / Auth0)</text></switch></g></g><g data-cell-id="HJKx42f4Jz2vHTe7KREf-7"><g transform="translate(0.5,0.5)"><rect x="10" y="80" width="550" height="130" fill="none" stroke="#000000" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 540px; height: 1px; padding-top: 145px; margin-left: 16px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 126px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div>- OAuth 2.0 login flow</div><div>- JWT tokens (tenant_id, sub, roles[], scopes[], exp, iat)</div><div>- JWKS endpoint for token verification</div><div>- Token refresh &amp; revocation</div><div>- Principal:</div><div><span style="white-space: pre;">	</span>sub, tenant_id, </div><div><span style="white-space: pre;">	</span>roles: [admin, operator, user, viewer], </div><div><span style="white-space: pre;">	</span>scopes: [read, write, graph:read, ...]</div></div></div></div></foreignObject><text x="16" y="149" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px">- OAuth 2.0 login flow...</text></switch></g></g></g></g><g data-cell-id="HJKx42f4Jz2vHTe7KREf-14"><g transform="translate(0.5,0.5)"><path d="M 10 480 L 10 450 L 560 450 L 560 480" fill="#f3f0ff" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(243, 240, 255), rgb(31, 28, 41)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 10 480 L 10 540 L 560 540 L 560 480" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 10 480 L 560 480" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 548px; height: 1px; padding-top: 465px; margin-left: 11px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style="text-align: left;"><div><b>Reverse Proxy / API Gateway (NGINX)</b></div></div></div></div></div></foreignObject><text x="285" y="469" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">Reverse Proxy / API Gateway (NGINX)</text></switch></g></g><g data-cell-id="HJKx42f4Jz2vHTe7KREf-15"><g transform="translate(0.5,0.5)"><rect x="10" y="480" width="550" height="60" fill="none" stroke="#000000" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 540px; height: 1px; padding-top: 510px; margin-left: 16px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 56px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">- </span><span style="background-color: transparent;">TLS termination (HTTPS) </span></div><div>- Routing to backend services</div><div>- CORS handling</div><div>- Load balancing </div></div></div></div></foreignObject><text x="16" y="514" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px">- TLS termination (HTTPS)...</text></switch></g></g></g></g><g data-cell-id="jL9Ayfw5SwNCbvacDRDm-101"><g transform="translate(0.5,0.5)"><path d="M 290 245 L 290 215 L 560 215 L 560 245" fill="#f3f0ff" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(243, 240, 255), rgb(31, 28, 41)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 290 245 L 290 435 L 560 435 L 560 245" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 290 245 L 560 245" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 268px; height: 1px; padding-top: 230px; margin-left: 291px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style="text-align: left;"><div><b>Control Panel UI (Streamlit)</b></div></div></div></div></div></foreignObject><text x="425" y="234" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">Control Panel UI (Streamlit)</text></switch></g></g><g data-cell-id="jL9Ayfw5SwNCbvacDRDm-102"><g transform="translate(0.5,0.5)"><rect x="290" y="245" width="270" height="190" fill="none" stroke="#000000" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 260px; height: 1px; padding-top: 340px; margin-left: 296px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 186px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div><div>[LONG-RUNNING JOBS - <span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">WORKFLOW B</span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">]</span></div><div><br /></div><div>- Admin/Operator dashboard</div><div>- Jobs, models, tools management</div><div>- Graph/NL-&gt;Cypher experiments</div><div>- SSE streaming for job events</div><div>- ETL, backup, maintenance triggers</div></div><div><br /></div><div><span style="background-color: transparent;"><div style="">POST /v1/jobs</div><div style="">- Bearer JWT, type, payload</div><div style="">- Job Types: demo, test, long-running, agent.run</div><div style="">- Returns: {id, status, created_at}</div></span></div></div></div></div></foreignObject><text x="296" y="344" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px">[LONG-RUNNING JOBS - WORKFLOW B]...</text></switch></g></g></g></g><g data-cell-id="omoz_kK5t07KWPeOI-yI-89"><g transform="translate(0.5,0.5)"><path d="M 10 245 L 10 215 L 280 215 L 280 245" fill="#f3f0ff" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(243, 240, 255), rgb(31, 28, 41)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 10 245 L 10 435 L 280 435 L 280 245" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 10 245 L 280 245" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 268px; height: 1px; padding-top: 230px; margin-left: 11px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style="text-align: left;"><div><b>Agent Chat UI (Next.js / React)</b></div></div></div></div></div></foreignObject><text x="145" y="234" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">Agent Chat UI (Next.js / React)</text></switch></g></g><g data-cell-id="omoz_kK5t07KWPeOI-yI-90"><g transform="translate(0.5,0.5)"><rect x="10" y="245" width="270" height="190" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 260px; height: 1px; padding-top: 340px; margin-left: 16px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 186px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div><div>[AGENT RUN - WORKFLOW A]</div><div><br /></div><div>- End user chat interface</div><div>- JWT-based authentication</div><div>- SSE Streaming support</div><div>- Agent runs &amp; steps display</div><div>- Real-time polling for updates</div></div><div><br /></div><div><div style="font-size: 11px; text-wrap-mode: nowrap;">POST /v1/agent-runs</div><div style="font-size: 11px; text-wrap-mode: nowrap;">- Bearer JWT, prompt, model, temperature</div><div style="font-size: 11px; text-wrap-mode: nowrap;">- Returns: {run_id, status: "queued"}</div></div><div style="font-size: 11px; text-wrap-mode: nowrap;"><br /></div></div></div></div></foreignObject><text x="16" y="344" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px">[AGENT RUN - WORKFLOW A]...</text></switch></g></g></g></g></g><g data-cell-id="jL9Ayfw5SwNCbvacDRDm-104"><g transform="translate(0.5,0.5)"><path d="M 285 855 L 285 943.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 285 948.88 L 281.5 941.88 L 285 943.63 L 288.5 941.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g data-cell-id="omoz_kK5t07KWPeOI-yI-96"><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 921px; margin-left: 286px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; ">WORKFLOW B</div></div></div></foreignObject><text x="286" y="925" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="11px" text-anchor="middle">WORKFLOW B</text></switch></g></g></g></g><g data-cell-id="omoz_kK5t07KWPeOI-yI-99"><g transform="translate(0.5,0.5)"><path d="M 285 855 L 285 890 L 945 890 L 945 943.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 945 948.88 L 941.5 941.88 L 945 943.63 L 948.5 941.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g data-cell-id="omoz_kK5t07KWPeOI-yI-101"><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 921px; margin-left: 946px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; ">WORKFLOW A</div></div></div></foreignObject><text x="946" y="924" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="11px" text-anchor="middle">WORKFLOW A</text></switch></g></g></g></g><g data-cell-id="EiYPZZWAnG0CHaq9ObTb-1"><g transform="translate(0.5,0.5)"><path d="M 0 645 L 0 615 L 570 615 L 570 645" fill="#d7e4d7" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(215, 228, 215), rgb(36, 47, 36)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 0 645 L 0 855 L 570 855 L 570 645" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 0 645 L 570 645" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 568px; height: 1px; padding-top: 630px; margin-left: 1px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style="text-align: left;"><div><b>API LAYER (Routers)</b></div></div></div></div></div></foreignObject><text x="285" y="634" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">API LAYER (Routers)</text></switch></g></g><g data-cell-id="EiYPZZWAnG0CHaq9ObTb-2"><g transform="translate(0.5,0.5)"><rect x="0" y="645" width="570" height="210" fill="none" stroke="#000000" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 560px; height: 1px; padding-top: 750px; margin-left: 6px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 206px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div>- /v1/health<span style="white-space: pre;">	</span>- Health probes (live, ready, startup, components)</div><div>- /v1/auth  <span style="white-space: pre;">	</span>- Token introspection, identity verification</div><div>- /v1/agents     - Agent definitions and configurations</div><div>- /v1/agent-runs - Agent run lifecycle (create, poll, cancel)</div><div>- /v1/tools      <span style="white-space: pre;">	</span>- MCP tool registry and invocation</div><div>- /v1/jobs       <span style="white-space: pre;">	</span>- Async job lifecycle (create, stream, cancel)</div><div>- /v1/models   <span style="white-space: pre;">	</span>- Model and provider management</div><div>- /v1/admin     <span style="white-space: pre;">	</span>- Administrative operations</div><div>- /v1/tenants   <span style="white-space: pre;">	</span>- Multi-tenant configuration</div><div>- /v1/sessions <span style="white-space: pre;">	</span>- Session management</div><div>- /v1/graph     <span style="white-space: pre;">	</span>- Graph query endpoints</div><div>- /v1/batch     <span style="white-space: pre;">	</span>- Batch operations</div><div>- /v1/export    <span style="white-space: pre;">	</span>- Data export utilities</div><div>- /v1/internal  <span style="white-space: pre;">	</span>- Internal diagnostics</div></div></div></div></foreignObject><text x="6" y="754" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px">- /v1/health	- Health probes (live, ready, startup, components)...</text></switch></g></g></g></g><g data-cell-id="EiYPZZWAnG0CHaq9ObTb-81"><g transform="translate(0.5,0.5)"><path d="M 1230 1450 L 1265 1450 L 1265 1970 L 1293.63 1970" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1298.88 1970 L 1291.88 1973.5 L 1293.63 1970 L 1291.88 1966.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="EiYPZZWAnG0CHaq9ObTb-5"><g transform="translate(0.5,0.5)"><path d="M 660 1123 L 660 1100 L 1230 1100 L 1230 1123" fill="#ebdfbc" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(235, 223, 188), rgb(55, 45, 15)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 660 1123 L 660 1800 L 1230 1800 L 1230 1123" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 660 1123 L 1230 1123" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 568px; height: 1px; padding-top: 1112px; margin-left: 661px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; "><div>SERVICE LAYER</div></div></div></div></foreignObject><text x="945" y="1115" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">SERVICE LAYER</text></switch></g></g><g data-cell-id="EiYPZZWAnG0CHaq9ObTb-6"><g transform="translate(0.5,0.5)"><path d="M 670 1170 L 670 1140 L 1220 1140 L 1220 1170" fill="#fff2cc" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(255, 242, 204), rgb(40, 29, 0)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 670 1170 L 670 1640 L 1220 1640 L 1220 1170" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 670 1170 L 1220 1170" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 548px; height: 1px; padding-top: 1155px; margin-left: 671px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style="text-align: left;"><b>ORCHESTRATOR </b><b>SERVICE</b><b>: 1 Run per prompt, </b><span style="background-color: transparent; text-align: center;"><b>4 Phases</b></span></div></div></div></div></foreignObject><text x="945" y="1159" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">ORCHESTRATOR SERVICE: 1 Run per prompt, 4 Phases</text></switch></g></g><g data-cell-id="EiYPZZWAnG0CHaq9ObTb-7"><g transform="translate(0.5,0.5)"><rect x="670" y="1170" width="550" height="470" fill="none" stroke="#000000" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 540px; height: 1px; padding-top: 1405px; margin-left: 676px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 466px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div><b>PHASE 1) INTENT CLASSIFICATION:</b></div><div>- A<span style="background-color: transparent;">nalyzes prompt via LLM<br /></span><span style="background-color: transparent;">- Check params.category → Match prompt catalog → Apply classify_intent()</span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">:</span></div><div><div>  - CHAT - Conversational responses</div><div>  - GRAPH - Analytics, NL-&gt;Cypher queries</div><div>  - SECURITY - Security/permissions questions</div><div>  - ADMIN - Administrative write operations</div><div>  - DANGEROUS - Destructive ops → refuse + offer EXPLAIN</div><div>  - EXPLAIN - EXPLAIN-only query analysis</div></div><div><br /></div><div><span style="background-color: transparent;"><b>PHASE 2) TODO Planning</b></span><b> (multi-step run):</b></div><div><div style="">- LLM-based planning</div><div style="">- Input: Goal + Context + Schema → Output: TODO Array</div><div style="">- Planning Modes: full (LLM per TODO) | optional (try direct) | none (deterministic)</div></div><div style=""><br /></div><div><div><b>PHASE 3) Step Execution, <span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">FOR EACH TODO</span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">:</span></b></div><div>  1. Call LLM Provider (planner, reflector, responder)</div><div>  2. Invoke MCP Tools with RBAC check (34 tools available)</div><div>  3. If GRAPH mode: NL-&gt;Cypher pipeline</div><div>  4. Persist step → PostgreSQL <span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">(via adaptor)</span></div><div>  5. Use Redis for session/cache/cancel <span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">(via adaptor)</span></div><div>- Step records: {id, action, input, output, latency_ms, started_at, finished_at}</div></div><div><br /></div><div><div><b>PHASE 4) </b><b style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">Finalization &amp; </b><b style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">Response Generation</b></div><div><div>- build_response() → Orchestration Result</div><div>- Response mode selection: fallback-only | llm-best-effort</div><div>- Canonical output structure: {goal, steps[], outputs[], todos[], metrics}</div><div>- Normalize final output: text + optional JSON payload</div><div>- Safety/compliance: PII scrubbing + output guard checks</div><div>- Persist final state + metrics → PostgreSQL</div><div>- Observability: emit Prometheus metrics + OpenTelemetry traces</div></div></div></div></div></div></foreignObject><text x="676" y="1409" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px">PHASE 1) INTENT CLASSIFICATION:...</text></switch></g></g></g></g><g data-cell-id="EiYPZZWAnG0CHaq9ObTb-8"><g transform="translate(0.5,0.5)"><path d="M 670 1690 L 670 1660 L 1220 1660 L 1220 1690" fill="#fff2cc" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(255, 242, 204), rgb(40, 29, 0)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 670 1690 L 670 1780 L 1220 1780 L 1220 1690" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 670 1690 L 1220 1690" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 548px; height: 1px; padding-top: 1675px; margin-left: 671px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style="text-align: left;"><b>ADDITIONAL SERVICES</b></div></div></div></div></foreignObject><text x="945" y="1679" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">ADDITIONAL SERVICES</text></switch></g></g><g data-cell-id="EiYPZZWAnG0CHaq9ObTb-9"><g transform="translate(0.5,0.5)"><rect x="670" y="1690" width="550" height="90" fill="none" stroke="#000000" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 540px; height: 1px; padding-top: 1735px; margin-left: 676px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 86px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">- Session Service (state management)</span></div><div>- Job Service (job lifecycle)</div><div>- Default Model Resolver</div><div>- Health / ETL / Archive Services</div><div>- Invocation Store (audit trail)</div></div></div></div></foreignObject><text x="676" y="1739" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px">- Session Service (state management)...</text></switch></g></g></g></g></g><g data-cell-id="omoz_kK5t07KWPeOI-yI-110"><g transform="translate(0.5,0.5)"><path d="M 1300 787.5 L 935 787.56 L 935 750 L 576.37 750" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 571.12 750 L 578.12 746.5 L 576.37 750 L 578.12 753.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="EiYPZZWAnG0CHaq9ObTb-10"><g transform="translate(0.5,0.5)"><path d="M 1300 23 L 1300 0 L 2230 0 L 2230 23" fill="#ead6d6" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(234, 214, 214), rgb(63, 46, 46)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1300 23 L 1300 1050 L 2230 1050 L 2230 23" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1300 23 L 2230 23" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 928px; height: 1px; padding-top: 12px; margin-left: 1301px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; "><div style="text-align: left;"><b>SECURITY </b><span style="background-color: transparent; text-align: center;">MIDDLEWARE STACK</span></div></div></div></div></foreignObject><text x="1765" y="15" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">SECURITY MIDDLEWARE STACK</text></switch></g></g><g data-cell-id="EiYPZZWAnG0CHaq9ObTb-11"><g transform="translate(0.5,0.5)"><path d="M 1310 70 L 1310 40 L 2220 40 L 2220 70" fill="#ffe9e9" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(255, 233, 233), rgb(48, 29, 29)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1310 70 L 1310 130 L 2220 130 L 2220 70" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1310 70 L 2220 70" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 908px; height: 1px; padding-top: 55px; margin-left: 1311px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style=""><div><b>1. CORS Handler - Cross-Origin Resource Sharing policy enforcement</b></div></div></div></div></div></foreignObject><text x="1765" y="59" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">1. CORS Handler - Cross-Origin Resource Sharing policy enforcement</text></switch></g></g><g data-cell-id="EiYPZZWAnG0CHaq9ObTb-12"><g transform="translate(0.5,0.5)"><rect x="1310" y="70" width="910" height="60" fill="none" stroke="#000000" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 900px; height: 1px; padding-top: 100px; margin-left: 1316px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 56px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div>- Allowed origins, methods, headers configuration</div><div>- Preflight OPTIONS request handling</div><div>- Credentials and expose headers support</div></div></div></div></foreignObject><text x="1316" y="104" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px">- Allowed origins, methods, headers configuration...</text></switch></g></g></g></g><g data-cell-id="EiYPZZWAnG0CHaq9ObTb-13"><g transform="translate(0.5,0.5)"><path d="M 1310 170 L 1310 140 L 2220 140 L 2220 170" fill="#ffe9e9" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(255, 233, 233), rgb(48, 29, 29)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1310 170 L 1310 230 L 2220 230 L 2220 170" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1310 170 L 2220 170" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 908px; height: 1px; padding-top: 155px; margin-left: 1311px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style=""><div><b>2. Trace Context - OpenTelemetry distributed tracing context</b></div></div></div></div></div></foreignObject><text x="1765" y="159" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">2. Trace Context - OpenTelemetry distributed tracing context</text></switch></g></g><g data-cell-id="EiYPZZWAnG0CHaq9ObTb-14"><g transform="translate(0.5,0.5)"><rect x="1310" y="170" width="910" height="60" fill="none" stroke="#000000" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 900px; height: 1px; padding-top: 200px; margin-left: 1316px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 56px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div>- Injects/extracts W3C trace-context headers (traceparent, tracestate)</div><div>- Creates root span if missing, propagates existing trace</div><div>- Adds trace_id, span_id, parent_id to request context</div></div></div></div></foreignObject><text x="1316" y="204" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px">- Injects/extracts W3C trace-context headers (traceparent, tracestate)...</text></switch></g></g></g></g><g data-cell-id="EiYPZZWAnG0CHaq9ObTb-15"><g transform="translate(0.5,0.5)"><path d="M 1310 270 L 1310 240 L 2220 240 L 2220 270" fill="#ffe9e9" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(255, 233, 233), rgb(48, 29, 29)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1310 270 L 1310 350 L 2220 350 L 2220 270" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1310 270 L 2220 270" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 908px; height: 1px; padding-top: 255px; margin-left: 1311px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style=""><div><b>3. Auth JWT - JWT/OIDC token validation and principal extraction</b></div></div></div></div></div></foreignObject><text x="1765" y="259" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">3. Auth JWT - JWT/OIDC token validation and principal extraction</text></switch></g></g><g data-cell-id="EiYPZZWAnG0CHaq9ObTb-16"><g transform="translate(0.5,0.5)"><rect x="1310" y="270" width="910" height="80" fill="none" stroke="#000000" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 900px; height: 1px; padding-top: 310px; margin-left: 1316px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 76px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div>- Validates Bearer token via JWKS endpoint (RS256/RS384/RS512)</div><div>- Extracts claims: sub, tenant_id, roles[], scopes[], exp, iat</div><div><div>- RBAC &amp; Scope Enforcement for endpoints</div></div><div>- Builds Principal object for downstream authorization</div><div>   - Rejects expired/invalid/malformed tokens with 401 Unauthorized</div></div></div></div></foreignObject><text x="1316" y="314" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px">- Validates Bearer token via JWKS endpoint (RS256/RS384/RS512)...</text></switch></g></g></g></g><g data-cell-id="EiYPZZWAnG0CHaq9ObTb-17"><g transform="translate(0.5,0.5)"><path d="M 1310 500 L 1310 470 L 2220 470 L 2220 500" fill="#ffe9e9" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(255, 233, 233), rgb(48, 29, 29)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1310 500 L 1310 580 L 2220 580 L 2220 500" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1310 500 L 2220 500" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 908px; height: 1px; padding-top: 485px; margin-left: 1311px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style=""><div><b>4. Rate Limit - Redis-backed rate limiting with multiple dimensions</b></div></div></div></div></div></foreignObject><text x="1765" y="489" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">4. Rate Limit - Redis-backed rate limiting with multiple dimensions</text></switch></g></g><g data-cell-id="EiYPZZWAnG0CHaq9ObTb-18"><g transform="translate(0.5,0.5)"><rect x="1310" y="500" width="910" height="80" fill="none" stroke="#000000" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 900px; height: 1px; padding-top: 540px; margin-left: 1316px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 76px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div>- Per-user limits: ratelimit:user:{sub}</div><div>- Per-tenant limits: ratelimit:tenant:{tenant_id}</div><div>- Per-endpoint limits: ratelimit:endpoint:{method}:{path}</div><div>   - Sliding window algorithm, returns 429 Too Many Requests when exceeded</div><div>   - X-RateLimit-Limit, X-RateLimit-Remaining, X-RateLimit-Reset headers</div></div></div></div></foreignObject><text x="1316" y="544" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px">- Per-user limits: ratelimit:user:{sub}...</text></switch></g></g></g></g><g data-cell-id="EiYPZZWAnG0CHaq9ObTb-19"><g transform="translate(0.5,0.5)"><path d="M 1310 630 L 1310 600 L 2220 600 L 2220 630" fill="#ffe9e9" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(255, 233, 233), rgb(48, 29, 29)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1310 630 L 1310 700 L 2220 700 L 2220 630" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1310 630 L 2220 630" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 908px; height: 1px; padding-top: 615px; margin-left: 1311px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style=""><div><b>5. Tenant Resolver - Multi-tenancy isolation and context resolution</b></div></div></div></div></div></foreignObject><text x="1765" y="619" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">5. Tenant Resolver - Multi-tenancy isolation and context resolution</text></switch></g></g><g data-cell-id="EiYPZZWAnG0CHaq9ObTb-20"><g transform="translate(0.5,0.5)"><rect x="1310" y="630" width="910" height="70" fill="none" stroke="#000000" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 900px; height: 1px; padding-top: 665px; margin-left: 1316px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 66px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div>- Resolves tenant configuration from Redis cache or PostgreSQL</div><div>- Injects tenant_id filter into all database queries</div><div>- Enforces data isolation between tenants</div><div>   - Loads tenant-specific settings (model defaults, feature flags)</div></div></div></div></foreignObject><text x="1316" y="669" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px">- Resolves tenant configuration from Redis cache or PostgreSQL...</text></switch></g></g></g></g><g data-cell-id="EiYPZZWAnG0CHaq9ObTb-21"><g transform="translate(0.5,0.5)"><path d="M 1310 740 L 1310 710 L 2220 710 L 2220 740" fill="#ffe9e9" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(255, 233, 233), rgb(48, 29, 29)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1310 740 L 1310 810 L 2220 810 L 2220 740" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1310 740 L 2220 740" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 908px; height: 1px; padding-top: 725px; margin-left: 1311px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style=""><div><b>6. Input Guard - Request payload validation and sanitization</b></div></div></div></div></div></foreignObject><text x="1765" y="729" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">6. Input Guard - Request payload validation and sanitization</text></switch></g></g><g data-cell-id="EiYPZZWAnG0CHaq9ObTb-22"><g transform="translate(0.5,0.5)"><rect x="1310" y="740" width="910" height="70" fill="none" stroke="#000000" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 900px; height: 1px; padding-top: 775px; margin-left: 1316px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 66px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div>- Pydantic schema validation for all request bodies</div><div>- Injection prevention (SQL, Cypher, command injection patterns)</div><div>- Content-type validation and size limits</div><div>   - Malicious payload detection</div></div></div></div></foreignObject><text x="1316" y="779" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px">- Pydantic schema validation for all request bodies...</text></switch></g></g></g></g><g data-cell-id="EiYPZZWAnG0CHaq9ObTb-23"><g transform="translate(0.5,0.5)"><path d="M 1310 850 L 1310 820 L 2220 820 L 2220 850" fill="#ffe9e9" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(255, 233, 233), rgb(48, 29, 29)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1310 850 L 1310 920 L 2220 920 L 2220 850" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1310 850 L 2220 850" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 908px; height: 1px; padding-top: 835px; margin-left: 1311px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style=""><b>7. Output Guard - Response sanitization and compliance</b></div></div></div></div></foreignObject><text x="1765" y="839" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">7. Output Guard - Response sanitization and compliance</text></switch></g></g><g data-cell-id="EiYPZZWAnG0CHaq9ObTb-24"><g transform="translate(0.5,0.5)"><rect x="1310" y="850" width="910" height="70" fill="none" stroke="#000000" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 900px; height: 1px; padding-top: 885px; margin-left: 1316px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 66px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div>- PII scrubbing (email redaction, phone masking, SSN removal)</div><div>- Content filtering for sensitive data patterns</div><div>- Response size validation and truncation</div><div>   - Audit logging of all responses with correlation IDs</div></div></div></div></foreignObject><text x="1316" y="889" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px">- PII scrubbing (email redaction, phone masking, SSN removal)...</text></switch></g></g></g></g><g data-cell-id="EiYPZZWAnG0CHaq9ObTb-25"><g transform="translate(0.5,0.5)"><path d="M 1310 960 L 1310 930 L 2220 930 L 2220 960" fill="#ffe9e9" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(255, 233, 233), rgb(48, 29, 29)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1310 960 L 1310 1030 L 2220 1030 L 2220 960" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1310 960 L 2220 960" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 908px; height: 1px; padding-top: 945px; margin-left: 1311px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style=""><div><b>8. Error Handler - Centralized exception handling and error response formatting</b></div></div></div></div></div></foreignObject><text x="1765" y="949" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">8. Error Handler - Centralized exception handling and error response formatting</text></switch></g></g><g data-cell-id="EiYPZZWAnG0CHaq9ObTb-26"><g transform="translate(0.5,0.5)"><rect x="1310" y="960" width="910" height="70" fill="none" stroke="#000000" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 900px; height: 1px; padding-top: 995px; margin-left: 1316px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 66px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div>- PII scrubbing (email redaction, phone masking, SSN removal)</div><div>- Content filtering for sensitive data patterns</div><div>- Response size validation and truncation</div><div>   - Audit logging of all responses with correlation IDs</div></div></div></div></foreignObject><text x="1316" y="999" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px">- PII scrubbing (email redaction, phone masking, SSN removal)...</text></switch></g></g></g></g><g data-cell-id="EiYPZZWAnG0CHaq9ObTb-27"><g transform="translate(0.5,0.5)"><path d="M 1310 390 L 1310 360 L 2220 360 L 2220 390" fill="#ffe9e9" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(255, 233, 233), rgb(48, 29, 29)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1310 390 L 1310 460 L 2220 460 L 2220 390" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1310 390 L 2220 390" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 908px; height: 1px; padding-top: 375px; margin-left: 1311px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style="text-align: left;"><div><b>RBAC PERMISSION MATRIX</b></div></div></div></div></div></foreignObject><text x="1765" y="379" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">RBAC PERMISSION MATRIX</text></switch></g></g><g data-cell-id="EiYPZZWAnG0CHaq9ObTb-28"><g transform="translate(0.5,0.5)"><rect x="1310" y="390" width="910" height="70" fill="none" stroke="#000000" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 900px; height: 1px; padding-top: 425px; margin-left: 1316px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 66px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div>- admin:    <span style="white-space: pre;">	</span>agent-runs=CRUD,<span style="white-space: pre;">	</span>jobs=CRUD,<span style="white-space: pre;">	</span>tools=CRUD,<span style="white-space: pre;">	</span>tenants=CRUD,<span style="white-space: pre;">	</span>graph(write)=✓</div><div>- operator: <span style="white-space: pre;">	</span>agent-runs=CRU,  <span style="white-space: pre;">	</span>jobs=CRUD, <span style="white-space: pre;">	</span>tools=R,    <span style="white-space: pre;">	</span>tenants=R,    <span style="white-space: pre;">	</span><span style="white-space: pre;">	</span>graph(write)=✗</div><div>- user:     <span style="white-space: pre;">	</span><span style="white-space: pre;">	</span>agent-runs=CR,   <span style="white-space: pre;">	</span>jobs=CRD,  <span style="white-space: pre;">	</span>tools=R,    <span style="white-space: pre;">	</span>tenants=✗,    <span style="white-space: pre;">	</span><span style="white-space: pre;">	</span>graph(write)=✗</div><div>- viewer:   <span style="white-space: pre;">	</span>agent-runs=R,    <span style="white-space: pre;">	</span>jobs=R,    <span style="white-space: pre;">	</span>tools=R,    <span style="white-space: pre;">	</span>tenants=✗,    <span style="white-space: pre;">	</span><span style="white-space: pre;">	</span>graph(write)=✗</div></div></div></div></foreignObject><text x="1316" y="429" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px">- admin:    	agent-runs=CRUD,	jobs=CRUD,	tools=CRUD,	tenants=CRUD,	graph(write)=✓...</text></switch></g></g></g></g></g><g data-cell-id="EiYPZZWAnG0CHaq9ObTb-29"><g transform="translate(0.5,0.5)"><path d="M 1300 1323 L 1300 1300 L 2230 1300 L 2230 1323" fill="#ebded4" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(235, 222, 212), rgb(54, 43, 34)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1300 1323 L 1300 2640 L 2230 2640 L 2230 1323" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1300 1323 L 2230 1323" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 928px; height: 1px; padding-top: 1312px; margin-left: 1301px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; "><b style="text-align: left;">PHASE 3: Step Execution, <span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">FOR EACH TODO</span></b></div></div></div></foreignObject><text x="1765" y="1315" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">PHASE 3: Step Execution, FOR EACH TODO</text></switch></g></g><g data-cell-id="EiYPZZWAnG0CHaq9ObTb-30"><g transform="translate(0.5,0.5)"><path d="M 1310 1363 L 1310 1340 L 2220 1340 L 2220 1363" fill="#fff1e6" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(255, 241, 230), rgb(38, 26, 17)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1310 1363 L 1310 1570 L 2220 1570 L 2220 1363" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1310 1363 L 2220 1363" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 908px; height: 1px; padding-top: 1352px; margin-left: 1311px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; "><div style="text-align: left;"><span style="background-color: transparent;">Step 1) LLM PROVIDERS</span></div></div></div></div></foreignObject><text x="1765" y="1355" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">Step 1) LLM PROVIDERS</text></switch></g></g><g data-cell-id="EiYPZZWAnG0CHaq9ObTb-31"><g transform="translate(0.5,0.5)"><path d="M 1320 1510 L 1320 1480 L 1750 1480 L 1750 1510" fill="#fff1e6" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(255, 241, 230), rgb(38, 26, 17)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1320 1510 L 1320 1560 L 1750 1560 L 1750 1510" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1320 1510 L 1750 1510" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 428px; height: 1px; padding-top: 1495px; margin-left: 1321px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style="text-align: left;"><div><b>OpenAI</b></div></div></div></div></div></foreignObject><text x="1535" y="1499" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">OpenAI</text></switch></g></g><g data-cell-id="EiYPZZWAnG0CHaq9ObTb-32"><g transform="translate(0.5,0.5)"><rect x="1320" y="1510" width="430" height="50" fill="none" stroke="#000000" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 420px; height: 1px; padding-top: 1535px; margin-left: 1326px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 46px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">- Cloud LLM API</span></div><div>- GPT-4, GPT-3.5, etc.</div></div></div></div></foreignObject><text x="1326" y="1539" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px">- Cloud LLM API...</text></switch></g></g></g></g><g data-cell-id="EiYPZZWAnG0CHaq9ObTb-33"><g transform="translate(0.5,0.5)"><path d="M 1320 1410 L 1320 1380 L 2210 1380 L 2210 1410" fill="#fff1e6" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(255, 241, 230), rgb(38, 26, 17)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1320 1410 L 1320 1470 L 2210 1470 L 2210 1410" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1320 1410 L 2210 1410" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 888px; height: 1px; padding-top: 1395px; margin-left: 1321px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style="text-align: left;"><div><b>Ollama (Local)</b></div></div></div></div></div></foreignObject><text x="1765" y="1399" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">Ollama (Local)</text></switch></g></g><g data-cell-id="EiYPZZWAnG0CHaq9ObTb-34"><g transform="translate(0.5,0.5)"><rect x="1320" y="1410" width="890" height="60" fill="none" stroke="#000000" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 880px; height: 1px; padding-top: 1440px; margin-left: 1326px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 56px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div><div>- Local LLM hosting</div><div>- Self-hosted models:</div><div><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">(phi3:mini, </span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">Mistral, </span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">LLaMA, </span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">Qwen, </span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">Gemma)</span></div></div></div></div></div></foreignObject><text x="1326" y="1444" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px">- Local LLM hosting...</text></switch></g></g></g></g><g data-cell-id="EiYPZZWAnG0CHaq9ObTb-35"><g transform="translate(0.5,0.5)"><path d="M 1760 1510 L 1760 1480 L 2210 1480 L 2210 1510" fill="#fff1e6" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(255, 241, 230), rgb(38, 26, 17)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1760 1510 L 1760 1560 L 2210 1560 L 2210 1510" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1760 1510 L 2210 1510" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 448px; height: 1px; padding-top: 1495px; margin-left: 1761px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style=""><b>Azure OpenAI / Other Providers</b></div></div></div></div></foreignObject><text x="1985" y="1499" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">Azure OpenAI / Other Providers</text></switch></g></g><g data-cell-id="EiYPZZWAnG0CHaq9ObTb-36"><g transform="translate(0.5,0.5)"><rect x="1760" y="1510" width="450" height="50" fill="none" stroke="#000000" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 440px; height: 1px; padding-top: 1535px; margin-left: 1766px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 46px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">- Compatible OpenAI-style APIs</span></div><div>- Enterprise deployments</div></div></div></div></foreignObject><text x="1766" y="1539" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px">- Compatible OpenAI-style APIs...</text></switch></g></g></g></g></g><g data-cell-id="EiYPZZWAnG0CHaq9ObTb-37"><g transform="translate(0.5,0.5)"><path d="M 1310 1615 L 1310 1585 L 2220 1585 L 2220 1615" fill="#fff1e6" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(255, 241, 230), rgb(38, 26, 17)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1310 1615 L 1310 1955 L 2220 1955 L 2220 1615" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1310 1615 L 2220 1615" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 908px; height: 1px; padding-top: 1600px; margin-left: 1311px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; "><div style="text-align: left;"><div>Step 2) MCP RUNTIME &amp; TOOLS (34 Tools, 12 Categories)</div></div></div></div></div></foreignObject><text x="1765" y="1604" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">Step 2) MCP RUNTIME &amp; TOOLS (34 Tools, 12 Categories)</text></switch></g></g><g data-cell-id="EiYPZZWAnG0CHaq9ObTb-38"><g transform="translate(0.5,0.5)"><rect x="1310" y="1615" width="910" height="340" fill="none" stroke="#000000" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 900px; height: 1px; padding-top: 1785px; margin-left: 1316px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 336px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div><div>- Tool Registry (PostgreSQL-backed manifests)</div><div>- Tool Policies (RBAC per tool, required_scopes)</div><div>- MCP Runtime (ToolContext, audit logging)</div><div>- Tool Invocation: </div><div><span style="white-space: pre;">	</span>Request → Schema Validation → RBAC Check → Execute → Audit Log</div></div><div><br /></div><div><div><b>Tool Categories:</b></div><div>- GRAPH    <span style="white-space: pre;">	</span>- query, secure_query, generate_cypher, schema, explain</div><div>- SECURITY <span style="white-space: pre;">	</span>- describe_principal, allowed_operations, validate</div><div>- SYSTEM   <span style="white-space: pre;">	</span>- health, metrics, config, status</div><div>- CACHE    <span style="white-space: pre;">	</span>- get, set, delete, invalidate</div><div>- CATALOG  <span style="white-space: pre;">	</span>- discover, describe, search</div><div>- MODEL    <span style="white-space: pre;">	</span>- list, info, warmup, switch</div><div>- AGENT    <span style="white-space: pre;">	</span>- context, history, state</div><div>- ANALYTICS <span style="white-space: pre;">	</span>- query, aggregate, visualize</div><div>- ADMIN    <span style="white-space: pre;">	</span>- create_index, drop_index, constraint</div><div>- ETL      <span style="white-space: pre;">	<span style="white-space: pre;">	</span></span>- import, export, transform</div><div>- CRUD     <span style="white-space: pre;">	</span>- create_node, update_node, delete_node</div><div>- EXPORT   <span style="white-space: pre;">	</span>- csv, json, cypher</div></div><div><br /></div><div><div>Tool Manifest (from PostgreSQL):</div><div>{name, description, input_schema, required_scopes, </div><div>rate_limit: {requests: 100, window: 60}}</div></div><div><br /></div></div></div></div></foreignObject><text x="1316" y="1789" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px">- Tool Registry (PostgreSQL-backed manifests)...</text></switch></g></g></g></g><g data-cell-id="EiYPZZWAnG0CHaq9ObTb-39"><g transform="translate(0.5,0.5)"><path d="M 1310 2000 L 1310 1970 L 2220 1970 L 2220 2000" fill="#fff1e6" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(255, 241, 230), rgb(38, 26, 17)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1310 2000 L 1310 2130 L 2220 2130 L 2220 2000" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1310 2000 L 2220 2000" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 908px; height: 1px; padding-top: 1985px; margin-left: 1311px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style=""><div><b>Step 3) NL <span style="text-align: left;">→</span> CYPHER PIPELINE</b></div></div></div></div></div></foreignObject><text x="1765" y="1989" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">Step 3) NL → CYPHER PIPELINE</text></switch></g></g><g data-cell-id="EiYPZZWAnG0CHaq9ObTb-40"><g transform="translate(0.5,0.5)"><rect x="1310" y="2000" width="910" height="130" fill="none" stroke="#000000" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 900px; height: 1px; padding-top: 2065px; margin-left: 1316px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 126px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div><span style="text-align: center;">[In case of GRAPH mode]</span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"></span></div><div><span style="text-align: center;"><br /></span></div><div><div>1. Normalize NL prompt → standardize user question</div><div><div>2. Catalog lookup (check if query matches known patterns in prompt catalog)</div></div><div>3. Generate Cypher → LLM-based or test hints</div><div>4. Validate Safety → read-only enforcement, tenant boundaries, injection prevention</div><div>5. Execute on Memgraph → run validated Cypher query</div><div>6. Summarize Results → convert graph results to natural language</div></div></div></div></div></foreignObject><text x="1316" y="2069" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px">[In case of GRAPH mode]...</text></switch></g></g></g></g><g data-cell-id="L2pf3anQq07PFLFANsks-52"><g transform="translate(0.5,0.5)"><path d="M 1310 2173 L 1310 2150 L 2220 2150 L 2220 2173" fill="#eadfe9" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(234, 223, 233), rgb(49, 40, 48)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1310 2173 L 1310 2630 L 2220 2630 L 2220 2173" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1310 2173 L 2220 2173" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 908px; height: 1px; padding-top: 2162px; margin-left: 1311px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">DATA &amp; INFRASTRUCTURE LAYER</div></div></div></foreignObject><text x="1765" y="2165" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">DATA &amp; INFRASTRUCTURE LAYER</text></switch></g></g><g data-cell-id="L2pf3anQq07PFLFANsks-53"><g transform="translate(0.5,0.5)"><path d="M 1640 2220 L 1640 2190 L 1920 2190 L 1920 2220" fill="#eadfe9" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(234, 223, 233), rgb(49, 40, 48)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1640 2220 L 1640 2430 L 1920 2430 L 1920 2220" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1640 2220 L 1920 2220" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 278px; height: 1px; padding-top: 2205px; margin-left: 1641px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style="text-align: left;"><b>PostgreSQL</b></div></div></div></div></foreignObject><text x="1780" y="2209" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">PostgreSQL</text></switch></g></g><g data-cell-id="L2pf3anQq07PFLFANsks-54"><g transform="translate(0.5,0.5)"><rect x="1640" y="2220" width="280" height="210" fill="none" stroke="#000000" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 270px; height: 1px; padding-top: 2325px; margin-left: 1646px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 206px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div><div><b>Tables:</b></div><div>- tenants       <span style="white-space: pre;">	</span><span style="white-space: pre;">	</span>- Multi-tenant configurations</div><div>- agent_runs        <span style="white-space: pre;">	</span>- Agent run records with status</div><div>- steps             <span style="white-space: pre;">	</span>- Per-step execution records</div><div>- sessions          <span style="white-space: pre;">	</span>- User session state</div><div>- jobs              <span style="white-space: pre;">	<span style="white-space: pre;">	</span></span>- Async job records</div><div>- job_events        <span style="white-space: pre;">	</span>- Job progress events</div><div>- tool_manifests    <span style="white-space: pre;">	</span>- MCP tool definitions</div><div>- model_defaults    <span style="white-space: pre;">	</span>- Default model configurations</div><div>- audit_logs        <span style="white-space: pre;">	</span>- All action audit trail</div></div><div><div><br /></div><div>SQLAlchemy + Alembic migrations</div><div>Used by: App (Background Tasks) <span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">+ Workers</span></div></div></div></div></div></foreignObject><text x="1646" y="2329" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px">Tables:...</text></switch></g></g></g></g><g data-cell-id="L2pf3anQq07PFLFANsks-55"><g transform="translate(0.5,0.5)"><path d="M 1930 2220 L 1930 2190 L 2210 2190 L 2210 2220" fill="#eadfe9" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(234, 223, 233), rgb(49, 40, 48)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1930 2220 L 1930 2620 L 2210 2620 L 2210 2220" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1930 2220 L 2210 2220" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 278px; height: 1px; padding-top: 2205px; margin-left: 1931px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style="text-align: left;"><div><b>Memgraph (Graph Database)</b></div></div></div></div></div></foreignObject><text x="2070" y="2209" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">Memgraph (Graph Database)</text></switch></g></g><g data-cell-id="L2pf3anQq07PFLFANsks-56"><g transform="translate(0.5,0.5)"><rect x="1930" y="2220" width="280" height="400" fill="none" stroke="#000000" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 270px; height: 1px; padding-top: 2420px; margin-left: 1936px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 396px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div><b>Nodes (14 b</b><b style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">ioinformatics</b><b style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"> node types)</b></div><div>- (:User        <span style="white-space: pre;">	</span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">→ </span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">{user_id, firstName, lastName, user_name, email})</span></div><div>- (:Institution <span style="white-space: pre;">	</span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">→ </span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">{id, name, country, type})</span></div><div>- (:Task        <span style="white-space: pre;">	</span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">→ </span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">{task_id, status, start, tags}) — e.g., Blast, CreateDb, SearchbyTaxon, Bold, Command</span></div><div>- (:File        <span style="white-space: pre;">	</span>→ <span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">{file_id, user_filename, size, extension, bucket_name}) — e.g., Fasta, BlastDb, Xml, BlastedSeq</span></div><div>- (:Dataset     <span style="white-space: pre;">	</span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">→ </span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">{id, name, description, version})</span></div><div>- (:Sample      <span style="white-space: pre;">	</span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">→ </span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">{id, name, organism, tissue})</span></div><div>- (:Experiment<span style="white-space: pre;">	</span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">→ </span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">{id, name, protocol, date})</span></div><div>- (:Publication <span style="white-space: pre;">	</span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">→ </span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">{id, doi, title, journal, year})</span></div><div>- (:Gene        <span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">→ </span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">{id, symbol, name, chromosome})</span></div><div>- (:Protein     <span style="white-space: pre;">	</span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">→ </span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">{id, name, sequence, function})</span></div><div>- (:Pathway     <span style="white-space: pre;">	</span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">→ </span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">{id, name, description})</span></div><div>- (:Tool        <span style="white-space: pre;">	</span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">→ </span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">{id, name, version, type})</span></div><div>- (:Workflow    <span style="white-space: pre;">	</span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">→ </span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">{id, name, steps, inputs})</span></div><div>- (:Result      <span style="white-space: pre;">	</span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">→ </span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">{id, type, metrics, timestamp})</span></div><div><br /></div><div><b>Relationships (4 relationship types)</b></div><div><div>- (User)-[:WORKS_AT {since, role, department}]<span style="white-space: pre;">	<span style="white-space: pre;">	</span></span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">→</span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); white-space: pre;">	</span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">(Institution)</span></div><div>- (User)-[:RUNS]<span style="white-space: pre;">	</span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">→</span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); white-space: pre;">	</span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">(Task)</span></div><div>- (File)-[:INPUT]<span style="white-space: pre;">	</span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">→</span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); white-space: pre;">	</span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">(Task)</span></div><div>- (Task)-[:OUTPUT]<span style="white-space: pre;">	</span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">→</span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); white-space: pre;">	</span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">(File)</span></div></div></div></div></div></foreignObject><text x="1936" y="2424" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px">Nodes (14 bioinformatics node types)...</text></switch></g></g></g></g><g data-cell-id="L2pf3anQq07PFLFANsks-57"><g transform="translate(0.5,0.5)"><path d="M 1320 2220 L 1320 2190 L 1630 2190 L 1630 2220" fill="#eadfe9" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(234, 223, 233), rgb(49, 40, 48)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1320 2220 L 1320 2520 L 1630 2520 L 1630 2220" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1320 2220 L 1630 2220" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 308px; height: 1px; padding-top: 2205px; margin-left: 1321px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style="text-align: left;"><b>Redis (Cache &amp; Queues)</b></div></div></div></div></foreignObject><text x="1475" y="2209" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">Redis (Cache &amp; Queues)</text></switch></g></g><g data-cell-id="L2pf3anQq07PFLFANsks-58"><g transform="translate(0.5,0.5)"><rect x="1320" y="2220" width="310" height="300" fill="none" stroke="#000000" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 300px; height: 1px; padding-top: 2370px; margin-left: 1326px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 296px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><b>CACHE:</b></span></div><div>- session:{id}         <span style="white-space: pre;">	<span style="white-space: pre;">	</span></span>- Session data</div><div>- tenant:config:{id}   <span style="white-space: pre;">	</span>- Tenant configurations</div><div>- model:defaults:{id} <span style="white-space: pre;">	</span>- Model defaults</div><div><br /></div><div><div><b>QUEUES:</b></div><div>- jobs:queue:{type}    <span style="white-space: pre;">	</span>- Job queue (LPUSH/BRPOP)</div><div>- jobs:events:{id}     <span style="white-space: pre;">	</span>- SSE event buffer (ring)</div><div>- jobs:state:{id}      <span style="white-space: pre;">	</span><span style="white-space: pre;">	</span>- Job state (HASH)</div></div><div><br /></div><div><b>RATE LIMITING:</b></div><div>- ratelimit:user:{id}     <span style="white-space: pre;">	</span>- Per-user limits</div><div>- ratelimit:tenant:{id}   <span style="white-space: pre;">	</span>- Per-tenant limits</div><div>- ratelimit:endpoint:{}   <span style="white-space: pre;">	</span>- Per-endpoint limits</div><div><br /></div><div><b>CONTROL:</b></div><div>- idempotency:{key}    <span style="white-space: pre;">	</span>- Idempotency mapping</div><div>- circuit:{provider}   <span style="white-space: pre;">	<span style="white-space: pre;">	</span></span>- Circuit breaker state</div><div><br /></div><div>Used by: App (Background Tasks) + Workers</div></div></div></div></foreignObject><text x="1326" y="2374" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px">CACHE:...</text></switch></g></g></g></g></g></g><g data-cell-id="jL9Ayfw5SwNCbvacDRDm-103"><g transform="translate(0.5,0.5)"><path d="M 1765 2640 L 1765 2665 L 2015 2665 L 2015 2683.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 2015 2688.88 L 2011.5 2681.88 L 2015 2683.63 L 2018.5 2681.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g data-cell-id="omoz_kK5t07KWPeOI-yI-108"><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 2666px; margin-left: 1889px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; ">WORKFLOW B</div></div></div></foreignObject><text x="1889" y="2669" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="11px" text-anchor="middle">WORKFLOW B</text></switch></g></g></g></g><g data-cell-id="omoz_kK5t07KWPeOI-yI-105"><g transform="translate(0.5,0.5)"><path d="M 1765 2640 L 1765 2665 L 1540 2665 L 1540 2683.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1540 2688.88 L 1536.5 2681.88 L 1540 2683.63 L 1543.5 2681.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g data-cell-id="omoz_kK5t07KWPeOI-yI-107"><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 2666px; margin-left: 1650px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; ">WORKFLOW A</div></div></div></foreignObject><text x="1650" y="2669" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="11px" text-anchor="middle">WORKFLOW A</text></switch></g></g></g></g><g data-cell-id="EiYPZZWAnG0CHaq9ObTb-85"><g transform="translate(0.5,0.5)"><path d="M 660 1853 L 660 1830 L 1230 1830 L 1230 1853" fill="#e0e0e0" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(224, 224, 224), rgb(45, 45, 45)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 660 1853 L 660 2730 L 1230 2730 L 1230 1853" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 660 1853 L 1230 1853" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 568px; height: 1px; padding-top: 1842px; margin-left: 661px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #333333; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#333333, #c1c1c1); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; "><b style="text-align: left;">BACKGROUND FRAMEWORK</b></div></div></div></foreignObject><text x="945" y="1845" fill="#333333" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">BACKGROUND FRAMEWORK</text></switch></g></g><g data-cell-id="EiYPZZWAnG0CHaq9ObTb-72"><g transform="translate(0.5,0.5)"><path d="M 670 1900 L 670 1870 L 1220 1870 L 1220 1900" fill="#f3f3f3" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(243, 243, 243), rgb(28, 28, 28)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 670 1900 L 670 1980 L 1220 1980 L 1220 1900" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 670 1900 L 1220 1900" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 548px; height: 1px; padding-top: 1885px; margin-left: 671px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #333333; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#333333, #c1c1c1); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style="text-align: left;"><div><b>APScheduler</b></div></div></div></div></div></foreignObject><text x="945" y="1889" fill="#333333" font-family="Helvetica" font-size="12px" text-anchor="middle">APScheduler</text></switch></g></g><g data-cell-id="EiYPZZWAnG0CHaq9ObTb-73"><g transform="translate(0.5,0.5)"><rect x="670" y="1900" width="550" height="80" fill="none" stroke="#000000" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 540px; height: 1px; padding-top: 1940px; margin-left: 676px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 76px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div>Scheduled Tasks</div><div>- Health check (30s): Postgres ping, Redis ping, Memgraph ping, LLM warmup/availability</div><div>- Cleanup (hourly): stale/old sessions, expired/stale cache, expired jobs, old job records, orphan runs</div><div>- Backup (daily): PostgreSQL dump, Redis RDB snapshot, Memgraph archives, audit logs export</div><div>- Provider monitoring: provider health + metrics emission</div><div><br /></div></div></div></div></foreignObject><text x="676" y="1944" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px">Scheduled Tasks...</text></switch></g></g></g></g><g data-cell-id="EiYPZZWAnG0CHaq9ObTb-63"><g transform="translate(0.5,0.5)"><path d="M 670 2013 L 670 1990 L 1220 1990 L 1220 2013" fill="#e0e0e0" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(224, 224, 224), rgb(45, 45, 45)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 670 2013 L 670 2720 L 1220 2720 L 1220 2013" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 670 2013 L 1220 2013" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 548px; height: 1px; padding-top: 2002px; margin-left: 671px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #333333; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#333333, #c1c1c1); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; "><b style="text-align: left;">OBSERVABILITY &amp; MONITORING</b></div></div></div></foreignObject><text x="945" y="2005" fill="#333333" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">OBSERVABILITY &amp; MONITORING</text></switch></g></g><g data-cell-id="EiYPZZWAnG0CHaq9ObTb-64"><g transform="translate(0.5,0.5)"><path d="M 680 2550 L 680 2520 L 1210 2520 L 1210 2550" fill="#f3f3f3" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(243, 243, 243), rgb(28, 28, 28)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 680 2550 L 680 2710 L 1210 2710 L 1210 2550" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 680 2550 L 1210 2550" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 528px; height: 1px; padding-top: 2535px; margin-left: 681px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #333333; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#333333, #c1c1c1); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style="text-align: left;"><div><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><b>Prometheus (Metrics Collection)</b></span></div></div></div></div></div></foreignObject><text x="945" y="2539" fill="#333333" font-family="Helvetica" font-size="12px" text-anchor="middle">Prometheus (Metrics Collection)</text></switch></g></g><g data-cell-id="EiYPZZWAnG0CHaq9ObTb-65"><g transform="translate(0.5,0.5)"><rect x="680" y="2550" width="530" height="160" fill="none" stroke="#000000" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 520px; height: 1px; padding-top: 2630px; margin-left: 686px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 156px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">- Scrapes /metrics from: app &amp; workers</span></div><div>- Metrics collected:</div><div>  - HTTP request latency &amp; throughput</div><div>  - Agent run / step execution metrics</div><div>  - Tool invocation metrics</div><div>  - LLM token usage &amp; cost</div><div>  - LLM provider health / circuit breaker states</div><div>  - Job processing metrics</div><div>  - Job queue depths</div><div>  - System health status</div></div></div></div></foreignObject><text x="686" y="2634" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px">- Scrapes /metrics from: app &amp; workers...</text></switch></g></g></g></g><g data-cell-id="EiYPZZWAnG0CHaq9ObTb-66"><g transform="translate(0.5,0.5)"><path d="M 680 2400 L 680 2370 L 1210 2370 L 1210 2400" fill="#f3f3f3" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(243, 243, 243), rgb(28, 28, 28)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 680 2400 L 680 2510 L 1210 2510 L 1210 2400" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 680 2400 L 1210 2400" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 528px; height: 1px; padding-top: 2385px; margin-left: 681px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #333333; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#333333, #c1c1c1); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style="text-align: left;"><div><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><b>Grafana (Dashboards)</b></span></div></div></div></div></div></foreignObject><text x="945" y="2389" fill="#333333" font-family="Helvetica" font-size="12px" text-anchor="middle">Grafana (Dashboards)</text></switch></g></g><g data-cell-id="EiYPZZWAnG0CHaq9ObTb-67"><g transform="translate(0.5,0.5)"><rect x="680" y="2400" width="530" height="110" fill="none" stroke="#000000" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 520px; height: 1px; padding-top: 2455px; margin-left: 686px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 106px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">- Dashboards for:</span></div><div>  - HTTP request metrics</div><div>  - Agent run statistics (runs/steps)</div><div>  - Job processing &amp; queue metrics</div><div>  - Tool invocation stats</div><div>  - LLM provider health &amp; circuit breaker states</div><div>  - System / component health status</div></div></div></div></foreignObject><text x="686" y="2459" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px">- Dashboards for:...</text></switch></g></g></g></g><g data-cell-id="EiYPZZWAnG0CHaq9ObTb-68"><g transform="translate(0.5,0.5)"><path d="M 680 2060 L 680 2030 L 1210 2030 L 1210 2060" fill="#f3f3f3" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(243, 243, 243), rgb(28, 28, 28)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 680 2060 L 680 2180 L 1210 2180 L 1210 2060" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 680 2060 L 1210 2060" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 528px; height: 1px; padding-top: 2045px; margin-left: 681px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #333333; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#333333, #c1c1c1); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style="text-align: left;"><b>Instrumentation &amp; Endpoints</b></div></div></div></div></foreignObject><text x="945" y="2049" fill="#333333" font-family="Helvetica" font-size="12px" text-anchor="middle">Instrumentation &amp; Endpoints</text></switch></g></g><g data-cell-id="EiYPZZWAnG0CHaq9ObTb-69"><g transform="translate(0.5,0.5)"><rect x="680" y="2060" width="530" height="120" fill="none" stroke="#000000" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 520px; height: 1px; padding-top: 2120px; margin-left: 686px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 116px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">- Prometheus /metrics endpoint (exposed by app &amp; workers)</span></div><div>- OpenTelemetry tracing (OTLP export from app &amp; workers)</div><div>- Structured logging (JSON format)</div><div>- Health endpoints:</div><div>  - /v1/health/live</div><div>  - /v1/health/ready</div><div>  - /v1/health/startup</div><div>  - /v1/health/components</div></div></div></div></foreignObject><text x="686" y="2124" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px">- Prometheus /metrics endpoint (exposed by app &amp; workers)...</text></switch></g></g></g></g><g data-cell-id="EiYPZZWAnG0CHaq9ObTb-70"><g transform="translate(0.5,0.5)"><path d="M 680 2220 L 680 2190 L 1210 2190 L 1210 2220" fill="#f3f3f3" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(243, 243, 243), rgb(28, 28, 28)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 680 2220 L 680 2360 L 1210 2360 L 1210 2220" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 680 2220 L 1210 2220" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 528px; height: 1px; padding-top: 2205px; margin-left: 681px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #333333; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#333333, #c1c1c1); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style="text-align: left;"><div><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><b>Tracing (OTel Collector + APM Backend)</b></span></div></div></div></div></div></foreignObject><text x="945" y="2209" fill="#333333" font-family="Helvetica" font-size="12px" text-anchor="middle">Tracing (OTel Collector + APM Backend)</text></switch></g></g><g data-cell-id="EiYPZZWAnG0CHaq9ObTb-71"><g transform="translate(0.5,0.5)"><rect x="680" y="2220" width="530" height="140" fill="none" stroke="#000000" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 520px; height: 1px; padding-top: 2290px; margin-left: 686px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 136px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">- OTel Collector / APM:</span></div><div>  - Receives OTLP traces from: app &amp; workers</div><div>  - Exports to: Jaeger / Tempo / APM backend</div><div>- Trace spans include:</div><div>  - Agent run execution (end-to-end)</div><div>  - Step-by-step processing</div><div>  - Tool invocations</div><div>  - Database queries</div><div>  - Job lifecycle (enqueue → execute → complete/fail/cancel)</div><div><br /></div></div></div></div></foreignObject><text x="686" y="2294" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px">- OTel Collector / APM:...</text></switch></g></g></g></g></g></g><g data-cell-id="jL9Ayfw5SwNCbvacDRDm-108"><g transform="translate(0.5,0.5)"><path d="M 285 1050 L 285 1093.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 285 1098.88 L 281.5 1091.88 L 285 1093.63 L 288.5 1091.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g data-cell-id="omoz_kK5t07KWPeOI-yI-111"><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 1073px; margin-left: 286px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; ">WORKFLOW B</div></div></div></foreignObject><text x="286" y="1076" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="11px" text-anchor="middle">WORKFLOW B</text></switch></g></g></g></g><g data-cell-id="jL9Ayfw5SwNCbvacDRDm-99"><g transform="translate(0.5,0.5)"><path d="M 125 980 L 125 950 L 445 950 L 445 980" fill="#eaf7ea" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(234, 247, 234), rgb(20, 31, 20)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 125 980 L 125 1050 L 445 1050 L 445 980" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 125 980 L 445 980" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 318px; height: 1px; padding-top: 965px; margin-left: 126px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style="text-align: left;"><div><b>[<span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">LONG-RUNNING JOB ENDPOINTS</span>]</b></div></div></div></div></div></foreignObject><text x="285" y="969" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">[LONG-RUNNING JOB ENDPOINTS]</text></switch></g></g><g data-cell-id="jL9Ayfw5SwNCbvacDRDm-100"><g transform="translate(0.5,0.5)"><rect x="125" y="980" width="320" height="70" fill="none" stroke="#000000" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 310px; height: 1px; padding-top: 1015px; margin-left: 131px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 66px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">- POST /v1/jobs → HTTP 202 + Location header</span></div><div>- GET /v1/jobs/{id}</div><div>- GET /v1/jobs/{id}/events (SSE streaming)</div><div>- DELETE /v1/jobs/{id} (cancellation via Redis Lua script)</div></div></div></div></foreignObject><text x="131" y="1019" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px">- POST /v1/jobs → HTTP 202 + Location header...</text></switch></g></g></g></g><g data-cell-id="jL9Ayfw5SwNCbvacDRDm-107"><g transform="translate(0.5,0.5)"><path d="M 285 1310 L 285 1353.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 285 1358.88 L 281.5 1351.88 L 285 1353.63 L 288.5 1351.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="jL9Ayfw5SwNCbvacDRDm-20"><g transform="translate(0.5,0.5)"><path d="M 0 1130 L 0 1100 L 570 1100 L 570 1130" fill="#d7deeb" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(215, 222, 235), rgb(41, 47, 58)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 0 1130 L 0 1310 L 570 1310 L 570 1130" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 0 1130 L 570 1130" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 568px; height: 1px; padding-top: 1115px; margin-left: 1px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style="text-align: left;"><div><b>JOB CREATION &amp; ENQUEUE</b></div></div></div></div></div></foreignObject><text x="285" y="1119" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">JOB CREATION &amp; ENQUEUE</text></switch></g></g><g data-cell-id="jL9Ayfw5SwNCbvacDRDm-21"><g transform="translate(0.5,0.5)"><rect x="0" y="1130" width="570" height="180" fill="none" stroke="#000000" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 560px; height: 1px; padding-top: 1220px; margin-left: 6px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 176px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div>JOB CREATION FLOW:</div><div>- Validate job request (Pydantic schema)</div><div>- Validate payload against JSON Schema for job type</div><div>- Check idempotency key (Redis + PostgreSQL)</div><div>- Create Job record (status=queued) → PostgreSQL</div><div>- LPUSH job_id → Redis queue: jobs:queue:{type}</div><div>- HSET job state → Redis: jobs:state:{id}</div><div>- Cache idempotency mapping → Redis</div><div>- Return HTTP 202 + JobResponse {id, status, created_at} + Location header</div><div>- Job Types: demo, test, long-running, agent.run</div><div><br /></div><div>Redis Queue (Job IDs) → To Workers via BRPOP</div></div></div></div></foreignObject><text x="6" y="1224" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px">JOB CREATION FLOW:...</text></switch></g></g></g></g><g data-cell-id="jL9Ayfw5SwNCbvacDRDm-106"><g transform="translate(0.5,0.5)"><path d="M 570 1715 L 615 1715 L 615 1450 L 653.63 1450" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 658.88 1450 L 651.88 1453.5 L 653.63 1450 L 651.88 1446.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="jL9Ayfw5SwNCbvacDRDm-93"><g transform="translate(0.5,0.5)"><path d="M 0 1383 L 0 1360 L 570 1360 L 570 1383" fill="#d6e4eb" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(214, 228, 235), rgb(33, 45, 51)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 0 1383 L 0 2070 L 570 2070 L 570 1383" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 0 1383 L 570 1383" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 568px; height: 1px; padding-top: 1372px; margin-left: 1px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">WORKERS</div></div></div></foreignObject><text x="285" y="1375" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">WORKERS</text></switch></g></g><g data-cell-id="jL9Ayfw5SwNCbvacDRDm-94"><g transform="translate(0.5,0.5)"><path d="M 10 2000 L 10 1970 L 560 1970 L 560 2000" fill="#e9f7ff" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(233, 247, 255), rgb(17, 29, 36)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 10 2000 L 10 2060 L 560 2060 L 560 2000" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 10 2000 L 560 2000" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 548px; height: 1px; padding-top: 1985px; margin-left: 11px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style="text-align: left;"><b>SSE STREAMING TO CONTROL PANEL</b></div></div></div></div></foreignObject><text x="285" y="1989" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">SSE STREAMING TO CONTROL PANEL</text></switch></g></g><g data-cell-id="jL9Ayfw5SwNCbvacDRDm-95"><g transform="translate(0.5,0.5)"><rect x="10" y="2000" width="550" height="60" fill="none" stroke="#000000" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 540px; height: 1px; padding-top: 2030px; margin-left: 16px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 56px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div>- Control Panel subscribes: GET /v1/jobs/{id}/events (Server-Sent Events)</div><div>- Backend streams events from PostgreSQL + Redis buffer</div><div>- UI displays: real-time progress, logs, final status</div></div></div></div></foreignObject><text x="16" y="2034" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px">- Control Panel subscribes: GET /v1/jobs/{id}/events (Server-Sent Events)...</text></switch></g></g></g></g><g data-cell-id="jL9Ayfw5SwNCbvacDRDm-96"><g transform="translate(0.5,0.5)"><path d="M 10 1430 L 10 1400 L 560 1400 L 560 1430" fill="#e9f7ff" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(233, 247, 255), rgb(17, 29, 36)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 10 1430 L 10 1960 L 560 1960 L 560 1430" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 10 1430 L 560 1430" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 548px; height: 1px; padding-top: 1415px; margin-left: 11px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style="text-align: left;"><b>Job Processing Worker</b></div></div></div></div></foreignObject><text x="285" y="1419" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">Job Processing Worker</text></switch></g></g><g data-cell-id="jL9Ayfw5SwNCbvacDRDm-97"><g transform="translate(0.5,0.5)"><rect x="10" y="1430" width="550" height="530" fill="none" stroke="#000000" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 540px; height: 1px; padding-top: 1695px; margin-left: 16px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 526px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div>WORKER PROCESSING LOOP FOR EACH JOB:</div><div>1. Pop job ID: BRPOP jobs:queue:{type} (blocking wait)</div><div>2. Load job metadata from PostgreSQL</div><div>3. Check pre-execution cancellation flag (Redis)</div><div>4. Update status: queued → running</div><div>5. Append status event to job_events table</div><div>6. Start async heartbeat task</div><div>7. Execute handler (uses same adapters: Memgraph, LLM, Redis):</div><div>   - demo jobs: simple demonstration</div><div>   - test jobs: testing purposes</div><div>   - long-running jobs: extended analysis</div><div>   - agent.run jobs: async agent execution (orchestrator integration)</div><div>     • Load/Create AgentRun record → PostgreSQL</div><div>     • Update AgentRun status: queued → running</div><div>     • Emit SSE: agent_run_started</div><div>     • Initialize Orchestrator.from_env()</div><div>     • Emit SSE: orchestrator_init</div><div>     • Execute orchestrator.run() with timeout</div><div>     • LLM calls, MCP tools, Graph queries</div><div>     • Persist steps per-step → PostgreSQL</div><div>     • Session state → Redis</div><div>     • Check cancellation between steps</div><div>     • Emit progress events per orchestration step</div><div>     • Apply PII scrubbing &amp; output guard</div><div>     • Emit agent-specific Prometheus metrics</div><div>     • Update AgentRun status → succeeded | failed</div><div>8. Periodically check cancellation flags (Redis: jobs:cancel:{id})</div><div>9. Emit progress events → RPUSH jobs:events:{id} → SSE to Control Panel</div><div>10. On completion: status = finished | failed | cancelled</div><div>11. Persist result → PostgreSQL</div><div>12. Append terminal event to job_events</div><div><br /></div><div>Job Status State Machine: queued → running → finished | failed | cancelled</div><div><br /></div><div>Resources: 2 CPU, 4GB RAM</div><div>Uses same adapters/services as main app (shared codebase)</div></div></div></div></foreignObject><text x="16" y="1699" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px">WORKER PROCESSING LOOP FOR EACH JOB:...</text></switch></g></g></g></g></g><g data-cell-id="jL9Ayfw5SwNCbvacDRDm-60"><g transform="translate(0.5,0.5)"><path d="M 1800 2720 L 1800 2690 L 2230 2690 L 2230 2720" fill="#dae4e6" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(218, 228, 230), rgb(36, 45, 47)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1800 2720 L 1800 2810 L 2230 2810 L 2230 2720" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1800 2720 L 2230 2720" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 428px; height: 1px; padding-top: 2705px; margin-left: 1801px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style="text-align: left;"><div><b style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">PHASE 4) </b><b>Long-Running Job Completion</b></div></div></div></div></div></foreignObject><text x="2015" y="2709" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">PHASE 4) Long-Running Job Completion</text></switch></g></g><g data-cell-id="jL9Ayfw5SwNCbvacDRDm-61"><g transform="translate(0.5,0.5)"><rect x="1800" y="2720" width="430" height="90" fill="none" stroke="#000000" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 420px; height: 1px; padding-top: 2765px; margin-left: 1806px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 86px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div>- State machine: queued → running → finished | failed | cancelled</div><div>- Persist job status → PostgreSQL</div><div>- Append progress/state events → job_events table</div><div>- Progress event format: {stage, message, percent}</div><div>- Stream updates via SSE to Control Panel (heartbeat keep-alive)</div><div>- Emit and persist terminal status: finished | failed | cancelled</div></div></div></div></foreignObject><text x="1806" y="2769" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px">- State machine: queued → running → finished | failed | cancelled...</text></switch></g></g></g></g><g data-cell-id="omoz_kK5t07KWPeOI-yI-97"><g transform="translate(0.5,0.5)"><path d="M 945 1050 L 945 1093.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 945 1098.88 L 941.5 1091.88 L 945 1093.63 L 948.5 1091.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g data-cell-id="omoz_kK5t07KWPeOI-yI-102"><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 1075px; margin-left: 946px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; ">WORKFLOW A</div></div></div></foreignObject><text x="946" y="1078" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="11px" text-anchor="middle">WORKFLOW A</text></switch></g></g></g></g><g data-cell-id="omoz_kK5t07KWPeOI-yI-91"><g transform="translate(0.5,0.5)"><path d="M 775 980 L 775 950 L 1115 950 L 1115 980" fill="#eaf7ea" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(234, 247, 234), rgb(20, 31, 20)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 775 980 L 775 1050 L 1115 1050 L 1115 980" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 775 980 L 1115 980" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 338px; height: 1px; padding-top: 965px; margin-left: 776px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style="text-align: left;"><div><b>[AGENT RUN ENDPOINTS]</b></div></div></div></div></div></foreignObject><text x="945" y="969" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">[AGENT RUN ENDPOINTS]</text></switch></g></g><g data-cell-id="omoz_kK5t07KWPeOI-yI-92"><g transform="translate(0.5,0.5)"><rect x="775" y="980" width="340" height="70" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 330px; height: 1px; padding-top: 1015px; margin-left: 781px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 66px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div>- POST /v1/agent-runs (use_jobs=false → BackgroundTasks)</div><div>- POST /v1/agent-runs?use_jobs=true (→ Jobs Worker)</div><div>- GET /v1/agent-runs/{id} (ETag support for caching)</div><div>- GET /v1/agent-runs/{id}/steps</div></div></div></div></foreignObject><text x="781" y="1019" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px">- POST /v1/agent-runs (use_jobs=false → BackgroundTasks)...</text></switch></g></g></g></g><g data-cell-id="omoz_kK5t07KWPeOI-yI-98"><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 1582px; margin-left: 614px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; ">WORKFLOW B</div></div></div></foreignObject><text x="614" y="1585" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="11px" text-anchor="middle">WORKFLOW B</text></switch></g></g></g><g data-cell-id="omoz_kK5t07KWPeOI-yI-103"><g transform="translate(0.5,0.5)"><path d="M 1300 2720 L 1300 2690 L 1780 2690 L 1780 2720" fill="#dae4e6" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(218, 228, 230), rgb(36, 45, 47)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1300 2720 L 1300 2810 L 1780 2810 L 1780 2720" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1300 2720 L 1780 2720" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 478px; height: 1px; padding-top: 2705px; margin-left: 1301px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style="text-align: left;"><b>PHASE 4) Agent Run Completion</b></div></div></div></div></foreignObject><text x="1540" y="2709" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">PHASE 4) Agent Run Completion</text></switch></g></g><g data-cell-id="omoz_kK5t07KWPeOI-yI-104"><g transform="translate(0.5,0.5)"><rect x="1300" y="2720" width="480" height="90" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 470px; height: 1px; padding-top: 2765px; margin-left: 1306px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 86px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">- State machine: queued → running → succeeded | failed</span></div><div>- Record provenance event for the completed run</div><div>- Build API payload: AgentRunResponse {id, status, outputs[], steps[], todos[], metrics}</div><div>- Return HTTP response to client</div><div>- UI polling for updates: GET /agent-runs/{id} (ETag support)</div></div></div></div></foreignObject><text x="1306" y="2769" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px">- State machine: queued → running → succeeded | failed...</text></switch></g></g></g></g><g data-cell-id="L2pf3anQq07PFLFANsks-40"><g transform="translate(0.5,0.5)"><path d="M 1300 1123 L 1300 1100 L 2230 1100 L 2230 1123" fill="#eafffb" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(234, 255, 251), rgb(8, 26, 23)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1300 1123 L 1300 1280 L 2230 1280 L 2230 1123" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1300 1123 L 2230 1123" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 928px; height: 1px; padding-top: 1112px; margin-left: 1301px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">ADAPTERS &amp; RESILIENCE FRAMEWORK</div></div></div></foreignObject><text x="1765" y="1115" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">ADAPTERS &amp; RESILIENCE FRAMEWORK</text></switch></g></g><g data-cell-id="L2pf3anQq07PFLFANsks-41"><g transform="translate(0.5,0.5)"><path d="M 1316.25 1170 L 1316.25 1140 L 1490 1140 L 1490 1170" fill="#eafffb" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(234, 255, 251), rgb(8, 26, 23)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1316.25 1170 L 1316.25 1270 L 1490 1270 L 1490 1170" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1316.25 1170 L 1490 1170" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 172px; height: 1px; padding-top: 1155px; margin-left: 1317px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style="text-align: left;"><b>LLM Adapters</b></div></div></div></div></foreignObject><text x="1403" y="1159" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">LLM Adapters</text></switch></g></g><g data-cell-id="L2pf3anQq07PFLFANsks-42"><g transform="translate(0.5,0.5)"><rect x="1316.25" y="1170" width="173.75" height="100" fill="none" stroke="#000000" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 164px; height: 1px; padding-top: 1220px; margin-left: 1322px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 96px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">- Ollama adapter (local LLMs)</span></div><div><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">- OpenAI-style API adapter</span></div><div>- Stub/Demo adapter (testing)</div><div>- Azure OpenAI adapter</div></div></div></div></foreignObject><text x="1322" y="1224" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px">- Ollama adapter (local LLM...</text></switch></g></g></g></g><g data-cell-id="L2pf3anQq07PFLFANsks-43"><g transform="translate(0.5,0.5)"><path d="M 1498.13 1170 L 1498.13 1140 L 1910 1140 L 1910 1170" fill="#eafffb" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(234, 255, 251), rgb(8, 26, 23)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1498.13 1170 L 1498.13 1270 L 1910 1270 L 1910 1170" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1498.13 1170 L 1910 1170" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 410px; height: 1px; padding-top: 1155px; margin-left: 1499px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style="text-align: left;"><b>Resilience Mechanisms</b></div></div></div></div></foreignObject><text x="1704" y="1159" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">Resilience Mechanisms</text></switch></g></g><g data-cell-id="L2pf3anQq07PFLFANsks-44"><g transform="translate(0.5,0.5)"><rect x="1498.13" y="1170" width="411.87" height="100" fill="none" stroke="#000000" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 402px; height: 1px; padding-top: 1220px; margin-left: 1504px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 96px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div>- Circuit Breaker States per provider: </div><div><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><span style="white-space: pre;">	</span>CLOSED (normal) → OPEN (reject) → </span></div><div><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><span style="white-space: pre;">	</span>HALF_OPEN (test one) → CLOSED</span></div><div><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">- Automatic Retries with exponential backoff</span></div><div>- Cost Tracking per provider/model</div><div>- Provider Fallback chain</div></div></div></div></foreignObject><text x="1504" y="1224" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px">- Circuit Breaker States per provider:...</text></switch></g></g></g></g><g data-cell-id="L2pf3anQq07PFLFANsks-45"><g transform="translate(0.5,0.5)"><path d="M 1920 1170 L 1920 1140 L 2220 1140 L 2220 1170" fill="#eafffb" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(234, 255, 251), rgb(8, 26, 23)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1920 1170 L 1920 1270 L 2220 1270 L 2220 1170" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1920 1170 L 2220 1170" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 298px; height: 1px; padding-top: 1155px; margin-left: 1921px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">Database Adapters</div></div></div></foreignObject><text x="2070" y="1159" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">Database Adapters</text></switch></g></g><g data-cell-id="L2pf3anQq07PFLFANsks-46"><g transform="translate(0.5,0.5)"><path d="M 1930 1210 L 1930 1180 L 2010 1180 L 2010 1210" fill="#eafffb" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(234, 255, 251), rgb(8, 26, 23)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1930 1210 L 1930 1260 L 2010 1260 L 2010 1210" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1930 1210 L 2010 1210" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 1195px; margin-left: 1931px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style=""><div><b>Redis Adapter</b></div></div></div></div></div></foreignObject><text x="1970" y="1199" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">Redis Adapter</text></switch></g></g><g data-cell-id="L2pf3anQq07PFLFANsks-47"><g transform="translate(0.5,0.5)"><rect x="1930" y="1210" width="80" height="50" fill="none" stroke="#000000" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 70px; height: 1px; padding-top: 1235px; margin-left: 1936px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 46px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">- cache</span></div><div><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">- queues</span></div><div><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">- rate limits</span></div></div></div></div></foreignObject><text x="1936" y="1239" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px">- cache...</text></switch></g></g></g></g><g data-cell-id="L2pf3anQq07PFLFANsks-48"><g transform="translate(0.5,0.5)"><path d="M 2015 1210 L 2015 1180 L 2105 1180 L 2105 1210" fill="#eafffb" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(234, 255, 251), rgb(8, 26, 23)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 2015 1210 L 2015 1260 L 2105 1260 L 2105 1210" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 2015 1210 L 2105 1210" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 88px; height: 1px; padding-top: 1195px; margin-left: 2016px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style=""><b>PostgreSQL Adapter</b></div></div></div></div></foreignObject><text x="2060" y="1199" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">PostgreSQL Adap...</text></switch></g></g><g data-cell-id="L2pf3anQq07PFLFANsks-49"><g transform="translate(0.5,0.5)"><rect x="2015" y="1210" width="90" height="50" fill="none" stroke="#000000" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 80px; height: 1px; padding-top: 1235px; margin-left: 2021px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 46px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div></div><div><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">- repositories</span></div><div><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">- transactions</span></div></div></div></div></foreignObject><text x="2021" y="1239" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px">- repositorie...</text></switch></g></g></g></g><g data-cell-id="L2pf3anQq07PFLFANsks-50"><g transform="translate(0.5,0.5)"><path d="M 2110 1210 L 2110 1180 L 2210 1180 L 2210 1210" fill="#eafffb" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(234, 255, 251), rgb(8, 26, 23)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 2110 1210 L 2110 1260 L 2210 1260 L 2210 1210" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 2110 1210 L 2210 1210" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 98px; height: 1px; padding-top: 1195px; margin-left: 2111px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style=""><div><b>Memgraph Adapter</b></div></div></div></div></div></foreignObject><text x="2160" y="1199" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">Memgraph Adapter</text></switch></g></g><g data-cell-id="L2pf3anQq07PFLFANsks-51"><g transform="translate(0.5,0.5)"><rect x="2110" y="1210" width="100" height="50" fill="none" stroke="#000000" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 90px; height: 1px; padding-top: 1235px; margin-left: 2116px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 46px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div></div><div><div><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">- graph queries</span></div><div><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">- NL-&gt;Cypher</span></div></div></div></div></div></foreignObject><text x="2116" y="1239" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px">- graph queries...</text></switch></g></g></g></g></g></g></g></g></g></svg>